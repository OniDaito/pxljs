<!DOCTYPE html><html lang="en"><head><title>math/math</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="math/math"><meta name="groc-project-path" content="src/math/math.coffee"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path">src/math/math.coffee</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><pre><code>              .__   
 _________  __|  |  
 \____ \  \/  /  |  
 |  |_&gt; &gt;    &lt;|  |__
 |   __/__/\_ \____/
 |__|        \/     js

                PXL.js
                Benjamin Blundell - ben@pxljs.com
                http://pxljs.com

This software is released under the MIT Licence. See LICENCE.txt for details


http://www.flipcode.com/documents/matrfaq.html
http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/index.htm</code></pre></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>The maths functons in PXLjs work as follows;
any instance function that doesnt return a different type to the instance, modifies 
that instance and returns a reference to the original. For example:</p>
<pre><code>Vec3 a(1,0,0); 
b = a.add(1,0,0);</code></pre></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p> b will be a pointer or reference to a which will now have the value (2,0,0)</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Class fucntions do the opposite to the above - they return a new version</p>
<pre><code>Vec3 a(1,0,0)
Vec3 b(2,0,0)
c = Vec3.add(a,b)</code></pre></div></div><div class="code"><div class="wrapper">    </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p> c is now a new vector in its own right, with value (3,0,0)</p></div></div><div class="code"><div class="wrapper">  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Functions that are exceptions to this are things like dot, equals and length which
return values that are not copies or references to thing being called upon.</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>TODO if we have Vec3 we should also have Mat3 instead of Matrix3</p></div></div><div class="code"><div class="wrapper">{PXLWarning} = <span class="hljs-built_in">require</span> <span class="hljs-string">'../util/log'</span>

<span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> Float32Array?
  glMatrixArrayType = Float32Array
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> WebGLFloatArray?
  glMatrixArrayType = WebGLFloatArray
<span class="hljs-keyword">else</span>
  glMatrixArrayType = Array</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Useful constants</p></div></div><div class="code"><div class="wrapper">EPSILON = <span class="hljs-number">4.37114e-05</span>
PI = <span class="hljs-number">3.14159</span>

sinx_over_x : <span class="hljs-function"><span class="hljs-params">(x)</span> -&gt;</span>
  <span class="hljs-keyword">if</span> x * x &lt; <span class="hljs-number">1.19209290e-07</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
  <span class="hljs-keyword">else</span>
    <span class="hljs-keyword">return</span> Math.sin(x) / x
<span class="hljs-function">
<span class="hljs-title">radToDeg</span> = <span class="hljs-params">(a)</span> -&gt;</span>
  a * <span class="hljs-number">57.2957795</span>
<span class="hljs-function">
<span class="hljs-title">degToRad</span> = <span class="hljs-params">(a)</span> -&gt;</span>
  a * <span class="hljs-number">0.017453292523928</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="vec2">Vec2</h2>
<p>A two component vector with x,y</p></div></div><div class="code"><div class="wrapper"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Vec2</span></span>

  DIM : <span class="hljs-number">2</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@sub</strong> - static function - non destructive subtraction.</p>
<ul>
<li><strong>a</strong> - Vec2</li>
<li><strong>b</strong> - Vec2</li>
<li>returns a new Vec2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@sub</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"sub"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@add</strong> - static function - non destructive subtraction.</p>
<ul>
<li><strong>a</strong> - Vec2</li>
<li><strong>b</strong> - Vec2</li>
<li>returns a new Vec2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@add</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"add"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@div</strong> - static function - non destructive division.</p>
<ul>
<li><strong>a</strong> - Vec2</li>
<li><strong>b</strong> - Vec2</li>
<li>returns a new Vec2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@div</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"div"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@mult</strong> - static function - non destructive multiplication.</p>
<ul>
<li><strong>a</strong> - Vec2</li>
<li><strong>b</strong> - Vec2</li>
<li>returns a new Vec2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@mult</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"mult"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@multScalar</strong> - static function - non destructive multiplication with a scalar.</p>
<ul>
<li><strong>a</strong> - Vec2</li>
<li><strong>b</strong> - Number</li>
<li>returns a new Vec2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@multScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"multScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@normalize</strong> static function - non destructive normalization.</p>
<ul>
<li><strong>a</strong> - Vec2</li>
<li>returns a new Vec2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@normalize</span>:<span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"normalize"</span>]()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@dot</strong> - static function - compute the dot product</p>
<ul>
<li><strong>a</strong> - Vec2</li>
<li><strong>b</strong> - Vec2</li>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@dot</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.dot(b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@constructor</strong> - Create a new Vec2</p>
<ul>
<li><strong>x</strong> - Number</li>
<li><strong>y</strong> - Number</li>
<li>returns a new Vec2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">constructor</span>: <span class="hljs-function"><span class="hljs-params">(x=<span class="hljs-number">0</span>,y=<span class="hljs-number">0</span>)</span> -&gt;</span>
  	[<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>] = [x,y]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>clone</strong> - make a clone of this vector</p>
<ul>
<li>returns a new Vec2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">clone</span>: <span class="hljs-function">-&gt;</span>
    <span class="hljs-keyword">new</span> Vec2(<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>copy</strong> - copy the value from another vector</p>
<ul>
<li><strong>a</strong> - Vec2</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">copy</span>: <span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    <span class="hljs-property">@x</span> = a.x
    <span class="hljs-property">@y</span> = a.y
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>length</strong> - return the length of this vector</p>
<ul>
<li>returns a number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">length</span>: <span class="hljs-function">-&gt;</span>
    Math.sqrt <span class="hljs-property">@lengthSquared</span>() 
  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>lengthSquared</strong> - return the squared length of this vector</p>
<ul>
<li>returns a number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">lengthSquared</span>: <span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@x</span> * <span class="hljs-property">@x</span> + <span class="hljs-property">@y</span> * <span class="hljs-property">@y</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>normalize</strong> - normalize this vector</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">normalize</span>: <span class="hljs-function">-&gt;</span>
    m = <span class="hljs-property">@length</span>()
    <span class="hljs-property">@multScalar</span>(<span class="hljs-number">1.0</span>/m) <span class="hljs-keyword">if</span> m &gt; <span class="hljs-number">0</span>
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>sub</strong> - subtract another vector from this one</p>
<ul>
<li><strong>v</strong> - a Vec2</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">sub</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@x</span> -= v.x
    <span class="hljs-property">@y</span> -= v.y
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>add</strong> - add another vector to this one</p>
<ul>
<li><strong>v</strong> - a Vec2</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">add</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@x</span> += v.x
    <span class="hljs-property">@y</span> += v.y
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>dv</strong> - return a new vector being the difference between this vector and another</p>
<ul>
<li><strong>v</strong> - a Vec2</li>
<li>returns a new Vec2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">dv</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-keyword">new</span> Vec2  Math.abs(<span class="hljs-property">@x</span> - v.x) Math.abs(<span class="hljs-property">@y</span> - v.y) </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>dist</strong> - return the distance between this and another vector</p>
<ul>
<li><strong>v</strong> - a Vec2</li>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">dist</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    Vec2.sub(@,v).length()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>distSquared</strong> - return the distance squared between this and another vector</p>
<ul>
<li><strong>v</strong> - a Vec2</li>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">distSquared</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    Vec2.sub(@,v).lengthSquared()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>div</strong> - divide by another vector n</p>
<ul>
<li><strong>n</strong> - a Vec2</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">div</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    [<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>] = [<span class="hljs-property">@x</span>/n.x,<span class="hljs-property">@y</span>/n.y]
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>mult</strong> - multiply by another vector v</p>
<ul>
<li><strong>v</strong> - a Vec2</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">mult</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    [<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>] = [<span class="hljs-property">@x</span>*v.x,<span class="hljs-property">@y</span>*v.y]
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>multScalar</strong> - multiply by a scalar n</p>
<ul>
<li><strong>n</strong> - a Vec2</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">multScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    [<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>] = [<span class="hljs-property">@x</span>*n,<span class="hljs-property">@y</span>*n]
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>equals</strong> - are these two vectors equal in size/direction</p>
<ul>
<li><strong>v</strong> a Vec2</li>
<li>returns a boolean</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">equals</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@x</span> == v.x <span class="hljs-keyword">and</span> <span class="hljs-property">@y</span> == v.y</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>dot</strong> - return the dot product between this and v</p>
<ul>
<li><strong>v</strong> a Vec2</li>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">dot</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@x</span>*v.x + <span class="hljs-property">@y</span>*v.y</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>invalid</strong> - is this vector actually valid</p>
<ul>
<li>returns a boolean</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">invalid</span>: <span class="hljs-function">-&gt;</span>
    <span class="hljs-keyword">return</span> (<span class="hljs-property">@x</span> == Infinity) || isNaN(<span class="hljs-property">@x</span>) || <span class="hljs-property">@y</span> == Infinity || isNaN(<span class="hljs-property">@y</span>)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>flatten</strong> - used by shaders to get a nice list</p>
<ul>
<li>returns a List of Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">flatten</span>: <span class="hljs-function">-&gt;</span>
    [<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>set</strong> - Short-hand to set the values in one go</p>
<ul>
<li><strong>x</strong> - Number</li>
<li><strong>y</strong> - Number</li>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  set : <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@x</span>, <span class="hljs-property">@y</span>)</span> -&gt;</span>
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="edge2">Edge2</h2>
<p>A container for two vertices, ordered as start and finish - directed</p></div></div><div class="code"><div class="wrapper"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Edge2</span></span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>constructor</strong> </p>
<ul>
<li><strong>start</strong> - a Vec2</li>
<li><strong>end</strong> - a Vec2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">constructor</span>: <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@start</span>, <span class="hljs-property">@end</span>)</span> -&gt;</span>
    @
    </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>equation</strong> - Convert this edge to a line in the form ax + by + c = 0</p>
<ul>
<li>returns a List of Number</li>
</ul></div></div><div class="code"><div class="wrapper">  equation : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    [<span class="hljs-property">@start</span>.y - <span class="hljs-property">@end</span>.y, <span class="hljs-property">@end</span>.x - <span class="hljs-property">@start</span>.x, <span class="hljs-property">@start</span>.x*<span class="hljs-property">@end</span>.y - <span class="hljs-property">@end</span>.x*<span class="hljs-property">@start</span>.y]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>sample</strong> - point on the line given x</p>
<ul>
<li><strong>x</strong> - Number</li>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  sample : <span class="hljs-function"><span class="hljs-params">(x)</span> -&gt;</span>
    [a,b,c] = <span class="hljs-property">@equation</span>()
    (-a*x-c) / b</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>length</strong> - return the length of this edge</p>
<ul>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  length : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-property">@end</span>.dist <span class="hljs-property">@start</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="halfedge2">HalfEdge2</h2>
<p><strong>Incomplete</strong>
An edge structure that points to the two faces it is connected to
start / end are vertices and @face0, @face1 are either triangles
or quads at present</p></div></div><div class="code"><div class="wrapper"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HalfEdge2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Edge2</span></span>

  constructor : <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@start</span>, <span class="hljs-property">@end</span>, <span class="hljs-property">@face0</span>, <span class="hljs-property">@face1</span>)</span> -&gt;</span>
    <span class="hljs-keyword">super</span>(<span class="hljs-property">@start</span>, <span class="hljs-property">@end</span>)
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="vec3">Vec3</h2>
<p>A 3 dimension vector (x,y,z)</p></div></div><div class="code"><div class="wrapper"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Vec3</span></span>

  DIM : <span class="hljs-number">3</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@sub</strong> - static function - non destructive subtraction.</p>
<ul>
<li><strong>a</strong> - a Vec3</li>
<li><strong>b</strong> - a Vec3</li>
<li>returns a new Vec3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@sub</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"sub"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@add</strong> - static function - non destructive addition.</p>
<ul>
<li><strong>a</strong> - a Vec3</li>
<li><strong>b</strong> - a Vec3</li>
<li>returns a new Vec3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@add</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"add"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@cross</strong> - static function - return the cross product.</p>
<ul>
<li><strong>a</strong> - a Vec3</li>
<li><strong>b</strong> - a Vec3</li>
<li>returns a new Vec3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@cross</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"cross"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@div</strong> - static function - non destructive division.</p>
<ul>
<li><strong>a</strong> - a Vec3</li>
<li><strong>b</strong> - a Vec3</li>
<li>returns a new Vec3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@div</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"div"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@mult</strong> - static function - non destructive multiplication.</p>
<ul>
<li><strong>a</strong> - a Vec3</li>
<li><strong>b</strong> - a Vec3</li>
<li>returns a new Vec3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@mult</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"mult"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@perp</strong> - static function - non destructive perpendicular.</p>
<ul>
<li><strong>a</strong> - a Vec3</li>
<li>returns a new Vec3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@perp</span>:<span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"perp"</span>]()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@multScalar</strong> - static function - non destructive multiplication by a scalar</p>
<ul>
<li><strong>a</strong> - a Vec3</li>
<li><strong>b</strong> - a Vec3</li>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@multScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"multScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@normalize</strong> - static function - non destructive normalization.</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@normalize</span>:<span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"normalize"</span>]()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@dot</strong> - static function - return the dot product.</p>
<ul>
<li><strong>a</strong> - a Vec3</li>
<li><strong>b</strong> - a Vec3</li>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@dot</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.dot(b)
      </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>constructor</strong></p>
<ul>
<li><strong>x</strong> - a Number</li>
<li><strong>y</strong> - a Number</li>
<li><strong>z</strong> - a Number</li>
<li>returns a new Vec3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">constructor</span>: <span class="hljs-function"><span class="hljs-params">(x=<span class="hljs-number">0</span>,y=<span class="hljs-number">0</span>,z=<span class="hljs-number">0</span>)</span> -&gt;</span>
  	[<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>,<span class="hljs-property">@z</span>] = [x,y,z]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>clone</strong> - make a clone of this vector</p>
<ul>
<li>returns a new Vec3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">clone</span>: <span class="hljs-function">-&gt;</span>
    <span class="hljs-keyword">new</span> Vec3(<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>,<span class="hljs-property">@z</span>)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>copy</strong> - copy the value from another vector</p>
<ul>
<li><strong>a</strong> - a Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">copy</span>: <span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    <span class="hljs-property">@x</span> = a.x
    <span class="hljs-property">@y</span> = a.y
    <span class="hljs-property">@z</span> = a.z
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>xy</strong> - a basic swizzle returning a new Vec2 from x and y</p>
<ul>
<li>returns a Vec2</li>
</ul></div></div><div class="code"><div class="wrapper">  xy : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-keyword">new</span> Vec3 <span class="hljs-property">@x</span>, <span class="hljs-property">@y</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>length</strong> - return the length of this vector</p>
<ul>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">length</span>: <span class="hljs-function">-&gt;</span>
    Math.sqrt <span class="hljs-property">@lengthSquared</span>()  
  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>lengthSquared</strong> - return the squared length of this vector</p>
<ul>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">lengthSquared</span>: <span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@x</span> * <span class="hljs-property">@x</span> + <span class="hljs-property">@y</span> * <span class="hljs-property">@y</span> + <span class="hljs-property">@z</span> * <span class="hljs-property">@z</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>normalize</strong> - normalize - destructive</p>
<ul>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">normalize</span>: <span class="hljs-function">-&gt;</span>
    m = <span class="hljs-property">@length</span>()
    <span class="hljs-property">@multScalar</span>(<span class="hljs-number">1.0</span>/m) <span class="hljs-keyword">if</span> m &gt; <span class="hljs-number">0</span>
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>sub</strong> - subtract another vector - destructive</p>
<ul>
<li><strong>v</strong> - a Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">sub</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@x</span> -= v.x
    <span class="hljs-property">@y</span> -= v.y
    <span class="hljs-property">@z</span> -= v.z
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>add</strong> - add another vector - destructive</p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">add</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@x</span> += v.x
    <span class="hljs-property">@y</span> += v.y
    <span class="hljs-property">@z</span> += v.z
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>cross</strong> - cross this vector with another vector - destructive</p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">cross</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    x = <span class="hljs-property">@y</span> * v.z - <span class="hljs-property">@z</span> * v.y 
    y = <span class="hljs-property">@z</span> * v.x - <span class="hljs-property">@x</span> * v.z 
    z = <span class="hljs-property">@x</span> * v.y - <span class="hljs-property">@y</span> * v.x
    <span class="hljs-property">@x</span> = x
    <span class="hljs-property">@y</span> = y
    <span class="hljs-property">@z</span> = z
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>dv</strong> - return a new vector being the difference between this vector and another (v)</p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">dv</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@x</span> = Math.abs(<span class="hljs-property">@x</span> - v.x)
    <span class="hljs-property">@y</span> = Math.abs(<span class="hljs-property">@y</span> - v.y)
    <span class="hljs-property">@z</span> = Math.abs(<span class="hljs-property">@z</span> - v.z)
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>dist</strong> - return the distance between this and another vector (v)</p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">dist</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    Vec3.sub(@,v).length()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>distSquared</strong> - return the distance squared between this and another vector (v)</p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">distSquared</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    Vec3.sub(@,v).lengthSquared()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>div</strong> - divide by another vector n </p>
<ul>
<li><strong>n</strong> - Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">div</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    [<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>,<span class="hljs-property">@z</span>] = [<span class="hljs-property">@x</span>/n.x,<span class="hljs-property">@y</span>/n.y,<span class="hljs-property">@z</span>/n.z]
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>perp</strong> - set this vector to one perpendicular to itself </p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  perp : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-property">@z</span> != <span class="hljs-number">0</span>
      <span class="hljs-property">@z</span> = (-<span class="hljs-property">@x</span> * <span class="hljs-number">2.0</span> - <span class="hljs-property">@y</span>) / <span class="hljs-property">@z</span>
      <span class="hljs-property">@x</span> = <span class="hljs-number">2.0</span>
      <span class="hljs-property">@y</span> = <span class="hljs-number">1.0</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-property">@y</span> != <span class="hljs-number">0</span>
      <span class="hljs-property">@y</span> = (-<span class="hljs-property">@x</span> * <span class="hljs-number">2.0</span> - <span class="hljs-property">@z</span>) / <span class="hljs-property">@y</span>
      <span class="hljs-property">@x</span> = <span class="hljs-number">2.0</span>
      <span class="hljs-property">@z</span> = <span class="hljs-number">1.0</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-property">@x</span> != <span class="hljs-number">0</span>
      <span class="hljs-property">@x</span> = (-<span class="hljs-property">@y</span> * <span class="hljs-number">2.0</span> - <span class="hljs-property">@z</span>) / <span class="hljs-property">@x</span>
      <span class="hljs-property">@y</span> = <span class="hljs-number">2.0</span>
      <span class="hljs-property">@z</span> = <span class="hljs-number">1.0</span>

    @ </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>mult</strong> - multiply by another vector v </p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">mult</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    [<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>,<span class="hljs-property">@z</span>] = [<span class="hljs-property">@x</span>*v.x,<span class="hljs-property">@y</span>*v.y,<span class="hljs-property">@z</span>*v.z]
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>multScalar</strong> - multiply by a scalar n</p>
<ul>
<li><strong>n</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">multScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    [<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>,<span class="hljs-property">@z</span>] = [<span class="hljs-property">@x</span>*n,<span class="hljs-property">@y</span>*n,<span class="hljs-property">@z</span>*n]
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>equals</strong> - are these two vectors equal in size/direction</p>
<ul>
<li><strong>v</strong> - Vec3
returns boolean</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">equals</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@x</span> == v.x <span class="hljs-keyword">and</span> <span class="hljs-property">@y</span> == v.y <span class="hljs-keyword">and</span> <span class="hljs-property">@z</span> == v.z</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>dot - return the dot product between this and v</p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li>return this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">dot</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@x</span>*v.x + <span class="hljs-property">@y</span>*v.y + <span class="hljs-property">@z</span>*v.z</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>invalid</strong> - is this vector actually valid</p>
<ul>
<li>returns boolean</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">invalid</span>: <span class="hljs-function">-&gt;</span>
    <span class="hljs-keyword">return</span> (<span class="hljs-property">@x</span> == Infinity) || isNaN(<span class="hljs-property">@x</span>) || <span class="hljs-property">@y</span> == Infinity || isNaN(<span class="hljs-property">@y</span>) || <span class="hljs-property">@z</span> == Infinity || isNaN(<span class="hljs-property">@z</span>)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>flatten</strong> - used by shaders to get a nice list</p>
<ul>
<li>returns List of Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">flatten</span>: <span class="hljs-function">-&gt;</span>
    [<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>,<span class="hljs-property">@z</span>]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>set</strong> - Short-hand to set the values in one go</p>
<ul>
<li><strong>x</strong> - Number</li>
<li><strong>y</strong> - Number</li>
<li><strong>z</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  set : <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@x</span>, <span class="hljs-property">@y</span>, <span class="hljs-property">@z</span>)</span> -&gt;</span>
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="vec4">Vec4</h2>
<p>A four dimensional vector (x,y,z,w)</p></div></div><div class="code"><div class="wrapper"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Vec4</span></span>

  DIM : <span class="hljs-number">4</span>
 </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@sub</strong> - static function - non destructive subtraction.</p>
<ul>
<li><strong>a</strong> - Vec4</li>
<li><strong>b</strong> - Vec4</li>
<li>returns new Vec4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@sub</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"sub"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@add</strong> - static function - non destructive addition.</p>
<ul>
<li><strong>a</strong> - Vec4</li>
<li><strong>b</strong> - Vec4</li>
<li>returns new Vec4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@add</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"add"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@cross</strong> - static function - return the cross product.</p>
<ul>
<li><strong>a</strong> - Vec4</li>
<li><strong>b</strong> - Vec4</li>
<li>returns new Vec4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@cross</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"cross"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@div</strong> - static function - non destructive division.</p>
<ul>
<li><strong>a</strong> - Vec4</li>
<li><strong>b</strong> - Vec4</li>
<li>returns new Vec4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@div</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"div"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@mult</strong> - static function - non destructive multiplication.</p>
<ul>
<li><strong>a</strong> - Vec4</li>
<li><strong>b</strong> - Vec4</li>
<li>returns new Vec4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@mult</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"mult"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@multScalar</strong> - static function - non destructive multiplication by a scalar</p>
<ul>
<li><strong>a</strong> - Vec4</li>
<li><strong>b</strong> - Number</li>
<li>returns Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@multScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"multScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@normalize</strong> - static function - non destructive normalization.</p>
<ul>
<li><strong>a</strong> - Vec4</li>
<li>returns new Vec4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@normalize</span>:<span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"normalize"</span>]()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@dot</strong> - static function - return the dot product.</p>
<ul>
<li><strong>a</strong> - Vec4</li>
<li><strong>b</strong> - Vec4</li>
<li>returns Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@dot</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.dot(b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>constructor</strong></p>
<ul>
<li><strong>x</strong> - Number - optional - default 0</li>
<li><strong>y</strong> - Number - optional - default 0</li>
<li><strong>z</strong> - Number - optional - default 0</li>
<li><strong>w</strong> - Number - optional - default 1</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">constructor</span>: <span class="hljs-function"><span class="hljs-params">(x=<span class="hljs-number">0</span>,y=<span class="hljs-number">0</span>,z=<span class="hljs-number">0</span>,w=<span class="hljs-number">1</span>)</span> -&gt;</span>
  	[<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>,<span class="hljs-property">@z</span>,<span class="hljs-property">@w</span>] = [x,y,z,w]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>clone</strong> - make a clone of this vector</p>
<ul>
<li>returns new Vec4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">clone</span>: <span class="hljs-function">-&gt;</span>
    <span class="hljs-keyword">new</span> Vec4(<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>,<span class="hljs-property">@z</span>,<span class="hljs-property">@w</span>)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>copy</strong> - copy the value from another vector</p>
<ul>
<li><strong>a</strong> - Vec4</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">copy</span>: <span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    <span class="hljs-property">@x</span> = a.x
    <span class="hljs-property">@y</span> = a.y
    <span class="hljs-property">@z</span> = a.z
    <span class="hljs-property">@w</span> = a.w
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>xyz</strong> - a basic swizzle returning a new Vec3</p>
<ul>
<li>returns new Vec3</li>
</ul></div></div><div class="code"><div class="wrapper">  xyz : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-keyword">new</span> Vec3 <span class="hljs-property">@x</span>, <span class="hljs-property">@y</span>, <span class="hljs-property">@z</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>length</strong> - return the length of this vector</p>
<ul>
<li>returns Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">length</span>: <span class="hljs-function">-&gt;</span>
    Math.sqrt <span class="hljs-property">@lengthSquared</span>() 
  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>lengthSquared</strong> - return the squared length of this vector</p>
<ul>
<li>returns Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">lengthSquared</span>: <span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@x</span> * <span class="hljs-property">@x</span> + <span class="hljs-property">@y</span> * <span class="hljs-property">@y</span> + <span class="hljs-property">@z</span> * <span class="hljs-property">@z</span> + <span class="hljs-property">@w</span> * <span class="hljs-property">@w</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>normalize</strong> - normalize - destructive</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">normalize</span>: <span class="hljs-function">-&gt;</span>
    m = <span class="hljs-property">@length</span>()
    <span class="hljs-property">@multScalar</span>(<span class="hljs-number">1.0</span>/m) <span class="hljs-keyword">if</span> m &gt; <span class="hljs-number">0</span>
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>sub</strong> - subtract another vector - destructive</p>
<ul>
<li><strong>v</strong> - Vec4</li>
<li>returns this  </li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">sub</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@x</span> -= v.x
    <span class="hljs-property">@y</span> -= v.y
    <span class="hljs-property">@z</span> -= v.z
    <span class="hljs-property">@w</span> -= v.w
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>equals</strong> - are these two vectors equal in size/direction</p>
<ul>
<li><strong>v</strong> - Vec4</li>
<li>returns boolean</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">equals</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@x</span> == v.x &amp;&amp; <span class="hljs-property">@y</span> == v.y &amp;&amp; <span class="hljs-property">@z</span> == v.z &amp;&amp; <span class="hljs-property">@w</span> == v.w</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>add</strong> - add another vector - destructive</p>
<ul>
<li><strong>v</strong> - Vec4</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">add</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@x</span> += v.x
    <span class="hljs-property">@y</span> += v.y
    <span class="hljs-property">@z</span> += v.z
    <span class="hljs-property">@w</span> += v.w
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>cross</strong> - cross this vector with another vector - destructive</p>
<ul>
<li><strong>v</strong> - Vec4</li>
<li>return this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">cross</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>No idea what to do with W here! :S</p></div></div><div class="code"><div class="wrapper">    x = <span class="hljs-property">@y</span> * v.z - <span class="hljs-property">@z</span> * v.y 
    y = <span class="hljs-property">@z</span> * v.x - <span class="hljs-property">@x</span> * v.z 
    z = <span class="hljs-property">@x</span> * v.y - <span class="hljs-property">@y</span> * v.x
    <span class="hljs-property">@x</span> = x
    <span class="hljs-property">@y</span> = y
    <span class="hljs-property">@z</span> = z
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>dv</strong> - set this vector to the difference between this vector and another (v)</p>
<ul>
<li><strong>v</strong> - Vec4</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">dv</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@x</span> = Math.abs(<span class="hljs-property">@x</span> - v.x)
    <span class="hljs-property">@y</span> = Math.abs(<span class="hljs-property">@y</span> - v.y)
    <span class="hljs-property">@z</span> = Math.abs(<span class="hljs-property">@z</span> - v.z)
    <span class="hljs-property">@w</span> = Math.abs(<span class="hljs-property">@w</span> - v.w) 
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>dist</strong> - return the distance between this and another vector (v)</p>
<ul>
<li><strong>v</strong> - Vec4</li>
<li>returns Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">dist</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    Vec4.sub(@,v).length()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>distSquared</strong> - return the distance squared between this and another vector (v)</p>
<ul>
<li><strong>v</strong> - Vec4</li>
<li>returns Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">distSquared</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    Vec4.sub(@,v).lengthSquared()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>div</strong> - divide by another vector n</p>
<ul>
<li><strong>n</strong> - Vec4</li>
<li>returns this </li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">div</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    [<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>,<span class="hljs-property">@z</span>,<span class="hljs-property">@w</span>] = [<span class="hljs-property">@x</span>/n.x,<span class="hljs-property">@y</span>/n.y,<span class="hljs-property">@z</span>/n.z,<span class="hljs-property">@w</span>/n.w]
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>mult</strong> - multiply by another vector v </p>
<ul>
<li><strong>v</strong> - Vec4</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">mult</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    [<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>,<span class="hljs-property">@z</span>,<span class="hljs-property">@w</span>] = [<span class="hljs-property">@x</span>*v.x,<span class="hljs-property">@y</span>*v.y,<span class="hljs-property">@z</span>*v.z,<span class="hljs-property">@w</span>*v.w]
    @ </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>multScalar</strong> - multiply by a scalar n</p>
<ul>
<li><strong>n</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">multScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    [<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>,<span class="hljs-property">@z</span>,<span class="hljs-property">@w</span>] = [<span class="hljs-property">@x</span>*n,<span class="hljs-property">@y</span>*n,<span class="hljs-property">@z</span>*n,<span class="hljs-property">@w</span>*n]
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>dot</strong> - return the dot porduct between this and v</p>
<ul>
<li><strong>v</strong> - Vec4</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">dot</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@x</span>*v.x + <span class="hljs-property">@y</span>*v.y + <span class="hljs-property">@z</span>*v.z + <span class="hljs-property">@w</span>*v.w</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>invalid</strong> - is this vector actually valid</p>
<ul>
<li>returns boolean</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">invalid</span>: <span class="hljs-function">-&gt;</span>
    <span class="hljs-keyword">return</span> (<span class="hljs-property">@x</span> == Infinity) || isNaN(<span class="hljs-property">@x</span>) || <span class="hljs-property">@y</span> == Infinity || isNaN(<span class="hljs-property">@y</span>) || <span class="hljs-property">@z</span> == Infinity || isNaN(<span class="hljs-property">@z</span>) || <span class="hljs-property">@w</span> == Infinity || isNaN(<span class="hljs-property">@w</span>)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>flatten</strong> - used by shaders to get a nice list</p>
<ul>
<li>returns List of Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">flatten</span>: <span class="hljs-function">-&gt;</span>
    [<span class="hljs-property">@x</span>,<span class="hljs-property">@y</span>,<span class="hljs-property">@z</span>,<span class="hljs-property">@w</span>]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>set</strong> - Short-hand to set the values in one go</p>
<ul>
<li><strong>x</strong> - Number</li>
<li><strong>y</strong> - Number</li>
<li><strong>z</strong> - Number</li>
<li><strong>w</strong> - Number</li>
</ul></div></div><div class="code"><div class="wrapper">  set : <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@x</span>, <span class="hljs-property">@y</span>, <span class="hljs-property">@z</span>, <span class="hljs-property">@w</span>)</span> -&gt;</span>
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="matrix2">Matrix2</h2>
<p>A 2x2 matrix in Column Major Format</p></div></div><div class="code"><div class="wrapper"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Matrix2</span></span>

  DIM : <span class="hljs-number">2</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@addScalar</strong> - static function - add a scalar to every element in this matrix</p>
<ul>
<li><strong>a</strong> - Matrix2</li>
<li><strong>b</strong> - Number</li>
<li>returns new Matrix2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@addScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"addScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@subScalar</strong> - static function - subtract a scalar from every element in this matrix</p>
<ul>
<li><strong>a</strong> - Matrix2</li>
<li><strong>b</strong> - Number</li>
<li>returns new Matrix2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@subScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"subScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@multScalar</strong> - static function - multiply every element in this matrix by a scalar</p>
<ul>
<li><strong>a</strong> - Matrix2</li>
<li><strong>b</strong> - Number</li>
<li>returns new Matrix2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@multScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"multScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@divScalar</strong> - static function - divide every element in this matrix by a scalar</p>
<ul>
<li><strong>a</strong> - Matrix2</li>
<li><strong>b</strong> - Number</li>
<li>returns new Matrix2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@divScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"divScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@mult</strong> - static function - multiply this matrix by another matrix</p>
<ul>
<li><strong>a</strong> - Matrix2</li>
<li><strong>b</strong> - Matrix2</li>
<li>returns new Matrix2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@mult</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"mult"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@multVec</strong> - static function - multiply a vector by this matrix, returning a new vector</p>
<ul>
<li><strong>m</strong> - Matrix2</li>
<li><strong>v</strong> - Vec2</li>
<li>returns new Vec2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@multVec</span>: <span class="hljs-function"><span class="hljs-params">(m,v)</span>-&gt;</span>
    tv = v.clone()
    m.multVec(tv)
    tv</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@transpose</strong> - static function - return the transpose of this matrix</p>
<ul>
<li><strong>a</strong> - Matrix2</li>
<li>returns new Matrix2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@transpose</span>:<span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    <span class="hljs-keyword">new</span> Matrix2 [a.a[<span class="hljs-number">0</span>],a.a[<span class="hljs-number">2</span>],a.a[<span class="hljs-number">1</span>],a.a[<span class="hljs-number">3</span>]]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>constructor</strong> Take a list in column major format</p>
<ul>
<li><strong>a</strong> - List of Number - Length 4 - Optional - Default [1,0,0,1]</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">constructor</span>: <span class="hljs-function"><span class="hljs-params">(a=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])</span> -&gt;</span>
    <span class="hljs-keyword">if</span> a <span class="hljs-keyword">instanceof</span> Matrix2
      <span class="hljs-property">@a</span> = a.a
    <span class="hljs-keyword">else</span>
      <span class="hljs-property">@a</span> = <span class="hljs-keyword">new</span> glMatrixArrayType(a)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>clone</strong> - return a clone of this matrix</p>
<ul>
<li>returns new Matrix2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">clone</span>: <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-keyword">new</span> Matrix2(<span class="hljs-property">@a</span>)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>copy</strong> - copy all the values from another matrix, a</p>
<ul>
<li><strong>a</strong> Matrix2</li>
<li></li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">copy</span>: <span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">0.</span><span class="hljs-number">.3</span>]
      <span class="hljs-property">@a</span>[i] = a.a[i]
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>multScalar</strong> - multiply this matrix by a scalar</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">multScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    <span class="hljs-property">@a</span> = ( num * n <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-property">@a</span> )
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>addScalar</strong> - add a scalar to every element</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">addScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    <span class="hljs-property">@a</span> = ( num + n <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-property">@a</span> )
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>subScalar</strong> - remove a scalar from every element</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">subScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    <span class="hljs-property">@a</span> = ( num - n <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-property">@a</span> )
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>divScalar</strong> - divide every element by a scalar</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">divScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    <span class="hljs-property">@a</span> = ( num / n <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-property">@a</span>)
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>identity</strong> - set this matrix to be the identity matrix</p></div></div><div class="code"><div class="wrapper">  identity : <span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@a</span>.set([<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])
    @
 </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>flatten</strong> - return the array part of this matrix</p></div></div><div class="code"><div class="wrapper">  flatten :<span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-property">@a</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>at</strong> - return the element at the row and column specified</p></div></div><div class="code"><div class="wrapper">  at : <span class="hljs-function"><span class="hljs-params">(r,c)</span> -&gt;</span>
    <span class="hljs-property">@a</span>[c * <span class="hljs-number">2</span> + r]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>mult</strong> - multiply this matrix by matrix m</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">mult</span>: <span class="hljs-function"><span class="hljs-params">(m)</span> -&gt;</span>

    a = <span class="hljs-keyword">new</span> Matrix2()

    a.a[ <span class="hljs-number">0</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*m.a[ <span class="hljs-number">0</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*m.a[ <span class="hljs-number">1</span>]
    a.a[ <span class="hljs-number">1</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*m.a[ <span class="hljs-number">0</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*m.a[ <span class="hljs-number">1</span>]
    a.a[ <span class="hljs-number">2</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*m.a[ <span class="hljs-number">2</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*m.a[ <span class="hljs-number">3</span>]
    a.a[ <span class="hljs-number">3</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*m.a[ <span class="hljs-number">2</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*m.a[ <span class="hljs-number">3</span>]
   
    <span class="hljs-property">@copy</span>(a)

    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>multVec</strong> - multiply vector v by this matrix - destructive to v</p>
<ul>
<li><strong>v</strong> - Vec2</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">multVec</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> v.z? <span class="hljs-keyword">or</span> v.w?
      PXLWarning <span class="hljs-string">"Mismatched vector and matrix dimensions"</span>
      <span class="hljs-keyword">return</span>
    x = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*v.x + <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*v.y
    y = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*v.x + <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*v.y

    v.x = x
    v.y = y
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>getCol</strong> - return a column from this matrix as a Vec2</p>
<ul>
<li><strong>c</strong> - Number</li>
<li>returns List of Number - Length 2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">getCol</span>: <span class="hljs-function"><span class="hljs-params">(c)</span>-&gt;</span>
    c = c * Matrix2.DIM
    Vec2 <span class="hljs-property">@a</span>[c + <span class="hljs-number">0</span>] <span class="hljs-property">@a</span>[c + <span class="hljs-number">1</span>]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>getRow</strong> - return a row from this matrix as a Vec2</p>
<ul>
<li><strong>r</strong> - Number</li>
<li>returns List of Number - Length 2</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">getRow</span>: <span class="hljs-function"><span class="hljs-params">(r)</span> -&gt;</span>
    Vec2 <span class="hljs-property">@a</span>[r + <span class="hljs-number">0</span>] <span class="hljs-property">@a</span>[r + <span class="hljs-number">2</span>]

      </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>transpose</strong> - transpose this matrix</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  transpose : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-property">@copy</span> <span class="hljs-keyword">new</span> Matrix2 [<span class="hljs-property">@a</span>[<span class="hljs-number">0</span>],a[<span class="hljs-number">2</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">1</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">3</span>]]
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>print</strong> - print this matrix to the console</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">print</span>: <span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span>
    <span class="hljs-built_in">console</span>.log <span class="hljs-property">@a</span>[<span class="hljs-number">0</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">2</span>]
    <span class="hljs-built_in">console</span>.log <span class="hljs-property">@a</span>[<span class="hljs-number">1</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">3</span>]
    @
  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>rotate</strong> - given an angle in radians, set this as a rotation matrix</p>
<ul>
<li><strong>a</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">rotate</span>: <span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>

    r = <span class="hljs-keyword">new</span> Matrix2()
    s = Math.sin a
    c = Math.cos a
   
    r.a[<span class="hljs-number">0</span>] = c
    r.a[<span class="hljs-number">1</span>] = s
    r.a[<span class="hljs-number">2</span>] = -s
    r.a[<span class="hljs-number">3</span>] = c

    <span class="hljs-property">@mult</span>(r)
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>scale</strong> - given a Vec3, create a scaling matrix</p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">scale</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Leave w</p></div></div><div class="code"><div class="wrapper">    r = <span class="hljs-keyword">new</span> Matrix3()
    r.a[<span class="hljs-number">0</span>] = v.x
    r.a[<span class="hljs-number">4</span>] = v.y
    r.a[<span class="hljs-number">8</span>] = v.z
    <span class="hljs-property">@mult</span>(r)
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="matrix3">Matrix3</h2>
<p>A 3x3 matrix in Column Major Format</p></div></div><div class="code"><div class="wrapper"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Matrix3</span></span>

  DIM : <span class="hljs-number">3</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@addScalar</strong> - static function - add a scalar to every element in this matrix</p>
<ul>
<li><strong>a</strong> - Matrix3</li>
<li><strong>b</strong> - Number</li>
<li>returns new Matrix3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@addScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"addScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@subScalar</strong> - static function - subtract a scalar from every element in this matrix</p>
<ul>
<li><strong>a</strong> - Matrix3</li>
<li><strong>b</strong> - Number</li>
<li>returns new Matrix3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@subScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"subScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@multScalar</strong> - static function - multiply every element in this matrix by a scalar</p>
<ul>
<li><strong>a</strong> - Matrix3</li>
<li><strong>b</strong> - Number</li>
<li>returns new Matrix3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@multScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"multScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@divScalar</strong> - static function - divide every element in this matrix by a scalar</p>
<ul>
<li><strong>a</strong> - Matrix3</li>
<li><strong>b</strong> - Number</li>
<li>returns new Matrix3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@divScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"divScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@mult</strong> - static function - multiply this matrix by another matrix</p>
<ul>
<li><strong>a</strong> - Matrix3</li>
<li><strong>b</strong> - Matrix3</li>
<li>returns new Matrix3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@mult</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"mult"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@invert</strong> - static function - return the inverse of this matrix</p>
<ul>
<li><strong>a</strong> - Matrix3</li>
<li>returns new Matrix3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@invert</span>:<span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    a[<span class="hljs-string">"_invert"</span>]()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@multVec</strong> - static function - multiply a vector by this matrix, returning a new vector</p>
<ul>
<li><strong>m</strong> - Matrix3</li>
<li><strong>v</strong> - Vec3</li>
<li>returns new Vec3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@multVec</span>: <span class="hljs-function"><span class="hljs-params">(m,v)</span>-&gt;</span>
    tv = v.clone()
    m.multVec(tv)
    tv</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@transpose</strong> - static function - return the transpose of this matrix</p>
<ul>
<li><strong>a</strong> - Matrix3</li>
<li>returns new Matrix3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@transpose</span>:<span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    <span class="hljs-keyword">new</span> Matrix3([ a.a.a.a[<span class="hljs-number">0</span>],a.a[<span class="hljs-number">3</span>],a.a[<span class="hljs-number">6</span>],a.a[<span class="hljs-number">1</span>],a.a[<span class="hljs-number">4</span>],a.a[<span class="hljs-number">7</span>],a.a[<span class="hljs-number">2</span>],a.a[<span class="hljs-number">5</span>],a.a[<span class="hljs-number">8</span>]])</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>constructor</strong></p>
<ul>
<li>a - List of Number - Length 9 - Optional - Default [1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0]</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">constructor</span>: <span class="hljs-function"><span class="hljs-params">(a=[<span class="hljs-number">1.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">1.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">1.0</span>])</span> -&gt;</span>
    <span class="hljs-keyword">if</span> a <span class="hljs-keyword">instanceof</span> Matrix3
      <span class="hljs-property">@a</span> = a.a
    <span class="hljs-keyword">else</span>
      <span class="hljs-property">@a</span> = <span class="hljs-keyword">new</span> glMatrixArrayType(a)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>clone</strong> - return a clone of this matrix</p>
<ul>
<li>returns new Matrix3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">clone</span>: <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-keyword">new</span> Matrix3(<span class="hljs-property">@a</span>)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>copy</strong> - copy all the values from another matrix, a</p>
<ul>
<li><strong>a</strong> - Matrix3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">copy</span>: <span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">0.</span><span class="hljs-number">.8</span>]
      <span class="hljs-property">@a</span>[i] = a.a[i]
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>multScalar - multiply this matrix by a scalar</p>
<ul>
<li><strong>n</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">multScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    <span class="hljs-property">@a</span> = ( num * n <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-property">@a</span> )
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>addScalar</strong> - add a scalar to every element</p>
<ul>
<li><strong>n</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">addScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    <span class="hljs-property">@a</span> = ( num + n <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-property">@a</span> )
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>subScalar</strong> - remove a scalar from every element</p>
<ul>
<li><strong>n</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">subScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    <span class="hljs-property">@a</span> = ( num - n <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-property">@a</span> )
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>divScalar</strong> - divide every element by a scalar</p>
<ul>
<li><strong>n</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">divScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    <span class="hljs-property">@a</span> = ( num / n <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-property">@a</span>)
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>identity</strong> - set this matrix to be the identity matrix</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  identity : <span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@a</span>.set([<span class="hljs-number">1.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">1.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">0.0</span>,<span class="hljs-number">1.0</span>])
    @
  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>at</strong> - return the element at the row and column specified</p>
<ul>
<li><strong>r</strong> - Number</li>
<li><strong>c</strong> - Number</li>
<li>returns Number</li>
</ul></div></div><div class="code"><div class="wrapper">  at : <span class="hljs-function"><span class="hljs-params">(r,c)</span> -&gt;</span>
    <span class="hljs-property">@a</span>[c * <span class="hljs-number">3</span> + r]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>mult</strong> - multiply this matrix by matrix m</p>
<ul>
<li><strong>m</strong> - Matrix3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">mult</span>: <span class="hljs-function"><span class="hljs-params">(m)</span> -&gt;</span>

    a = <span class="hljs-keyword">new</span> Matrix3()

    a.a[ <span class="hljs-number">0</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*m.a[ <span class="hljs-number">0</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*m.a[ <span class="hljs-number">1</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>]*m.a[ <span class="hljs-number">2</span>]
    a.a[ <span class="hljs-number">1</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*m.a[ <span class="hljs-number">0</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]*m.a[ <span class="hljs-number">1</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>]*m.a[ <span class="hljs-number">2</span>]
    a.a[ <span class="hljs-number">2</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*m.a[ <span class="hljs-number">0</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]*m.a[ <span class="hljs-number">1</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*m.a[ <span class="hljs-number">2</span>]
   
    
    a.a[ <span class="hljs-number">3</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*m.a[ <span class="hljs-number">3</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*m.a[ <span class="hljs-number">4</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>]*m.a[ <span class="hljs-number">5</span>]
    a.a[ <span class="hljs-number">4</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*m.a[ <span class="hljs-number">3</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]*m.a[ <span class="hljs-number">4</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>]*m.a[ <span class="hljs-number">5</span>]
    a.a[ <span class="hljs-number">5</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*m.a[ <span class="hljs-number">3</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]*m.a[ <span class="hljs-number">4</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*m.a[ <span class="hljs-number">5</span>]
   
    
    a.a[ <span class="hljs-number">6</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*m.a[ <span class="hljs-number">6</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*m.a[ <span class="hljs-number">7</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>]*m.a[ <span class="hljs-number">8</span>]
    a.a[ <span class="hljs-number">7</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*m.a[ <span class="hljs-number">6</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]*m.a[ <span class="hljs-number">7</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>]*m.a[ <span class="hljs-number">8</span>]
    a.a[ <span class="hljs-number">8</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*m.a[ <span class="hljs-number">6</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]*m.a[ <span class="hljs-number">7</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*m.a[ <span class="hljs-number">8</span>]
   
    <span class="hljs-property">@copy</span>(a)

    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>flatten</strong> - return the array part of this matrix</p></div></div><div class="code"><div class="wrapper">  flatten :<span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-property">@a</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>multVec</strong> - multiply vector v by this matrix - destructive to v</p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">multVec</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> v.z? <span class="hljs-keyword">or</span> v.w?
      PXLWarning <span class="hljs-string">"Mismatched vector and matrix dimensions"</span>
      <span class="hljs-keyword">return</span>
    x = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*v.x + <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*v.y + <span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>]*v.z
    y = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*v.x + <span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]*v.y + <span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>]*v.z
    z = <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*v.x + <span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]*v.y + <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*v.z

    v.x = x
    v.y = y
    v.z = z
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>getCol</strong> - return a column from this matrix as a Vec3</p>
<ul>
<li><strong>c</strong> - Number</li>
<li>returns Vec3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">getCol</span>: <span class="hljs-function"><span class="hljs-params">(c)</span>-&gt;</span>
    c = c * Matrix3.DIM
    Vec3 <span class="hljs-property">@a</span>[c + <span class="hljs-number">0</span>] <span class="hljs-property">@a</span>[c + <span class="hljs-number">1</span>] <span class="hljs-property">@a</span>[c + <span class="hljs-number">2</span>]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>getRow - return a row from this matrix as a Vec3</p>
<ul>
<li><strong>r</strong> - Number</li>
<li>returns Vec3</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">getRow</span>: <span class="hljs-function"><span class="hljs-params">(r)</span> -&gt;</span>
    Vec3 <span class="hljs-property">@a</span>[r + <span class="hljs-number">0</span>] <span class="hljs-property">@a</span>[r + <span class="hljs-number">3</span>] <span class="hljs-property">@a</span>[r + <span class="hljs-number">6</span>]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong><em>_invert</em></strong> - invert this matrix</p>
<ul>
<li>Internal</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">_invert</span>: <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    inv = <span class="hljs-keyword">new</span> Matrix3()
    epsilon = <span class="hljs-number">4.37114e-05</span>
    inv.a[<span class="hljs-number">0</span>] = <span class="hljs-property">@a</span>[<span class="hljs-number">4</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">8</span>] - <span class="hljs-property">@a</span>[<span class="hljs-number">5</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">7</span>]
    inv.a[<span class="hljs-number">1</span>] = <span class="hljs-property">@a</span>[<span class="hljs-number">2</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">7</span>] - <span class="hljs-property">@a</span>[<span class="hljs-number">1</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">8</span>]
    inv.a[<span class="hljs-number">2</span>] = <span class="hljs-property">@a</span>[<span class="hljs-number">1</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">5</span>] - <span class="hljs-property">@a</span>[<span class="hljs-number">2</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">4</span>]
    inv.a[<span class="hljs-number">3</span>] = <span class="hljs-property">@a</span>[<span class="hljs-number">5</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">6</span>] - <span class="hljs-property">@a</span>[<span class="hljs-number">3</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">8</span>]
    inv.a[<span class="hljs-number">4</span>] = <span class="hljs-property">@a</span>[<span class="hljs-number">0</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">8</span>] - <span class="hljs-property">@a</span>[<span class="hljs-number">2</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">6</span>]
    inv.a[<span class="hljs-number">5</span>] = <span class="hljs-property">@a</span>[<span class="hljs-number">2</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">3</span>] - <span class="hljs-property">@a</span>[<span class="hljs-number">0</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">5</span>]
    inv.a[<span class="hljs-number">6</span>] = <span class="hljs-property">@a</span>[<span class="hljs-number">3</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">7</span>] - <span class="hljs-property">@a</span>[<span class="hljs-number">4</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">6</span>]
    inv.a[<span class="hljs-number">7</span>] = <span class="hljs-property">@a</span>[<span class="hljs-number">1</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">6</span>] - <span class="hljs-property">@a</span>[<span class="hljs-number">0</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">7</span>]
    inv.a[<span class="hljs-number">8</span>] = <span class="hljs-property">@a</span>[<span class="hljs-number">0</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">4</span>] - <span class="hljs-property">@a</span>[<span class="hljs-number">1</span>] * <span class="hljs-property">@a</span>[<span class="hljs-number">3</span>]

    det  = <span class="hljs-property">@a</span>[<span class="hljs-number">0</span>] * inv.a[<span class="hljs-number">0</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">1</span>] * inv.a[<span class="hljs-number">3</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">2</span>] * inv.a[<span class="hljs-number">6</span>]

    <span class="hljs-keyword">if</span> Math.abs(det) &gt; epsilon
      invDet = <span class="hljs-number">1.0</span> / det
      inv.multScalar(invDet)
    inv</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>invert</strong> - invert this matrix</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">invert</span>: <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-property">@copy</span> <span class="hljs-property">@_invert</span>()
    @

 </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>transpose</strong> - transpose this matrix</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  transpose : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-property">@copy</span> <span class="hljs-keyword">new</span> Matrix3([<span class="hljs-property">@a</span>[<span class="hljs-number">0</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">3</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">6</span>], <span class="hljs-property">@a</span>[<span class="hljs-number">1</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">4</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">7</span>], <span class="hljs-property">@a</span>[<span class="hljs-number">2</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">5</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">8</span>]])
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>print</strong> - print this matrix to the console</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">print</span>: <span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span>
    <span class="hljs-built_in">console</span>.log <span class="hljs-property">@a</span>[<span class="hljs-number">0</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">3</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">6</span>]
    <span class="hljs-built_in">console</span>.log <span class="hljs-property">@a</span>[<span class="hljs-number">1</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">4</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">7</span>]
    <span class="hljs-built_in">console</span>.log <span class="hljs-property">@a</span>[<span class="hljs-number">2</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">5</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">8</span>]
  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>rotate</strong> - given a Vec3 and an angle in radians, create a rotation matrix</p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li><strong>a</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">rotate</span>: <span class="hljs-function"><span class="hljs-params">(v,a)</span> -&gt;</span>

    r = <span class="hljs-keyword">new</span> Matrix3()
    s = Math.sin a
    c = Math.cos a
    v.normalize()

    r.a[<span class="hljs-number">0</span>] = v.x * v.x * (<span class="hljs-number">1</span>-c) + c
    r.a[<span class="hljs-number">1</span>] = v.x * v.y * (<span class="hljs-number">1</span>-c) + v.z * s
    r.a[<span class="hljs-number">2</span>] = v.x * v.z * (<span class="hljs-number">1</span>-c) - v.y * s
    
    r.a[<span class="hljs-number">3</span>] = v.x * v.y * (<span class="hljs-number">1</span>-c) - v.z * s
    r.a[<span class="hljs-number">4</span>] = v.y * v.y * (<span class="hljs-number">1</span>-c) + c
    r.a[<span class="hljs-number">5</span>] = v.y * v.z * (<span class="hljs-number">1</span>-c) + v.x * s

    r.a[<span class="hljs-number">6</span>] = v.x * v.z * (<span class="hljs-number">1</span>-c) + v.y * s
    r.a[<span class="hljs-number">7</span>] = v.y * v.z * (<span class="hljs-number">1</span>-c) - v.x * s
    r.a[<span class="hljs-number">8</span>]= v.z * v.z * (<span class="hljs-number">1</span>-c) + c

    <span class="hljs-property">@mult</span>(r)
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>scale</strong> - given a Vec3, create a scaling matrix</p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">scale</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Leave w</p></div></div><div class="code"><div class="wrapper">    r = <span class="hljs-keyword">new</span> Matrix3()
    r.a[<span class="hljs-number">0</span>] = v.x
    r.a[<span class="hljs-number">4</span>] = v.y
    r.a[<span class="hljs-number">8</span>] = v.z
    <span class="hljs-property">@mult</span>(r)
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="matrix4">Matrix4</h2>
<p>Our 4x4 matrix</p></div></div><div class="code"><div class="wrapper"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Matrix4</span></span>
  DIM : <span class="hljs-number">4</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@addScalar</strong> - static function - adds a scalar to every element in the matrix</p>
<ul>
<li><strong>a</strong> - Matrix4</li>
<li><strong>b</strong> - Number</li>
<li>returns new Matrix4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@addScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"addScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@subScalar</strong> - static function - subtract a scalar from every element in this matrix</p>
<ul>
<li><strong>a</strong> - Matrix4</li>
<li><strong>b</strong> - Number</li>
<li>returns new Matrix4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@subScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"subScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@multScalar</strong> - static function - multiply every element in this matrix by a scalar</p>
<ul>
<li><strong>a</strong> - Matrix4</li>
<li><strong>b</strong> - Number</li>
<li>returns new Matrix4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@multScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"multScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@divScalar</strong> - static function - divide every element in this matrix by a scalar</p>
<ul>
<li><strong>a</strong> - Matrix4</li>
<li><strong>b</strong> - Number</li>
<li>returns new Matrix4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@divScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"divScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@mult</strong> - static function - multiply this matrix by another matrix</p>
<ul>
<li><strong>a</strong> - Matrix4</li>
<li><strong>b</strong> - Matrix4</li>
<li>returns new Matrix4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@mult</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"mult"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@invert</strong> - static function - return the inverse of this matrix</p>
<ul>
<li><strong>a</strong> - Matrix4</li>
<li>returns new Matrix4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@invert</span>:<span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    a[<span class="hljs-string">"_invert"</span>]()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@transpose</strong> - static function - return the transpose of this matrix</p>
<ul>
<li><strong>a</strong> - Matrix4</li>
<li>returns new Matrix4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@transpose</span>:<span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    <span class="hljs-keyword">new</span> Matrix4( [ a.a[<span class="hljs-number">0</span>], a.a[<span class="hljs-number">4</span>], a.a[<span class="hljs-number">8</span>], a.a[<span class="hljs-number">12</span>], a.a[<span class="hljs-number">1</span>], a.a[<span class="hljs-number">5</span>], a.a[<span class="hljs-number">9</span>], a.a[<span class="hljs-number">13</span>], a.a[<span class="hljs-number">2</span>], a.a[<span class="hljs-number">6</span>], a.a[<span class="hljs-number">10</span>], a.a[<span class="hljs-number">14</span>], a.a[<span class="hljs-number">3</span>], a.a[<span class="hljs-number">7</span>], a.a[<span class="hljs-number">11</span>], a.a[<span class="hljs-number">15</span>] ] )</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@multVec</strong> - static function - multiply a vector by this matrix, returning a new vector</p>
<ul>
<li><strong>m</strong> - Matrix4</li>
<li><strong>v</strong> - Vec4</li>
<li>returns new Vec4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@multVec</span>: <span class="hljs-function"><span class="hljs-params">(m,v)</span>-&gt;</span>
    tv = v.clone()
    m.multVec(tv)
    tv</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>constructor</strong></p>
<ul>
<li><strong>a</strong> - List of Number - Length 16 - Optional - Default [1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">constructor</span>: <span class="hljs-function"><span class="hljs-params">(a=[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])</span> -&gt;</span>
    <span class="hljs-keyword">if</span> a <span class="hljs-keyword">instanceof</span> Matrix4
      <span class="hljs-property">@a</span> = a.a
    <span class="hljs-keyword">else</span>
      <span class="hljs-property">@a</span> = <span class="hljs-keyword">new</span> glMatrixArrayType(a)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>clone</strong> - return a clone of this matrix</p>
<ul>
<li>returns new Matrix4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">clone</span>: <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-keyword">new</span> Matrix4(<span class="hljs-property">@a</span>)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>copy</strong> - copy all the values from another matrix, a</p>
<ul>
<li><strong>a</strong> - Matrix4</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">copy</span>: <span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">0.</span><span class="hljs-number">.15</span>]
      <span class="hljs-property">@a</span>[i] = a.a[i]
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>multScalar</strong> - multiply this matrix by a scalar</p>
<ul>
<li><strong>n</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">multScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    <span class="hljs-property">@a</span> = ( num * n <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-property">@a</span> )
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>addScalar</strong> - add a scalar to every element</p>
<ul>
<li><strong>n</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">addScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    <span class="hljs-property">@a</span> = ( num + n <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-property">@a</span> )
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>subScalar</strong> - remove a scalar from every element</p>
<ul>
<li><strong>n</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">subScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    <span class="hljs-property">@a</span> = ( num - n <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-property">@a</span> )
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>divScalar</strong> - divide every element by a scalar</p>
<ul>
<li><strong>n</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">divScalar</span>: <span class="hljs-function"><span class="hljs-params">(n)</span> -&gt;</span>
    <span class="hljs-property">@a</span> = ( num / n <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-property">@a</span>)
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>identity</strong> - set this matrix to be the identity matrix</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  identity : <span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@a</span>.set([<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])
    @
  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>at</strong> - return the element at the row and column specified</p>
<ul>
<li><strong>r</strong> - Number</li>
<li><strong>c</strong> - Number</li>
<li>returns Number</li>
</ul></div></div><div class="code"><div class="wrapper">  at : <span class="hljs-function"><span class="hljs-params">(r,c)</span> -&gt;</span>
    <span class="hljs-property">@a</span>[c * <span class="hljs-number">4</span> + r]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>getMatrix</strong>3 - return the 3x3 matrix from this 4x4 - top left part</p>
<ul>
<li>returns new Matrix3</li>
</ul></div></div><div class="code"><div class="wrapper">  getMatrix3 : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-keyword">new</span> Matrix3([ <span class="hljs-property">@a</span>[<span class="hljs-number">0</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">1</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">2</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">4</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">5</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">6</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">8</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">9</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">10</span>]])</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>mult</strong> - multiply this matrix by matrix m</p>
<ul>
<li><strong>m</strong> - Matrix4</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">mult</span>: <span class="hljs-function"><span class="hljs-params">(m)</span> -&gt;</span>
    a = <span class="hljs-keyword">new</span> Matrix4()
    a.a[ <span class="hljs-number">0</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*m.a[ <span class="hljs-number">0</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]*m.a[ <span class="hljs-number">1</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*m.a[ <span class="hljs-number">2</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">12</span>]*m.a[ <span class="hljs-number">3</span>]
    a.a[ <span class="hljs-number">1</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*m.a[ <span class="hljs-number">0</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]*m.a[ <span class="hljs-number">1</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">9</span>]*m.a[ <span class="hljs-number">2</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">13</span>]*m.a[ <span class="hljs-number">3</span>]
    a.a[ <span class="hljs-number">2</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*m.a[ <span class="hljs-number">0</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>]*m.a[ <span class="hljs-number">1</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">10</span>]*m.a[ <span class="hljs-number">2</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">14</span>]*m.a[ <span class="hljs-number">3</span>]
    a.a[ <span class="hljs-number">3</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*m.a[ <span class="hljs-number">0</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>]*m.a[ <span class="hljs-number">1</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">11</span>]*m.a[ <span class="hljs-number">2</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">15</span>]*m.a[ <span class="hljs-number">3</span>]
    
    a.a[ <span class="hljs-number">4</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*m.a[ <span class="hljs-number">4</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]*m.a[ <span class="hljs-number">5</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*m.a[ <span class="hljs-number">6</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">12</span>]*m.a[ <span class="hljs-number">7</span>]
    a.a[ <span class="hljs-number">5</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*m.a[ <span class="hljs-number">4</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]*m.a[ <span class="hljs-number">5</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">9</span>]*m.a[ <span class="hljs-number">6</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">13</span>]*m.a[ <span class="hljs-number">7</span>]
    a.a[ <span class="hljs-number">6</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*m.a[ <span class="hljs-number">4</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>]*m.a[ <span class="hljs-number">5</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">10</span>]*m.a[ <span class="hljs-number">6</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">14</span>]*m.a[ <span class="hljs-number">7</span>]
    a.a[ <span class="hljs-number">7</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*m.a[ <span class="hljs-number">4</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>]*m.a[ <span class="hljs-number">5</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">11</span>]*m.a[ <span class="hljs-number">6</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">15</span>]*m.a[ <span class="hljs-number">7</span>]
    
    a.a[ <span class="hljs-number">8</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*m.a[ <span class="hljs-number">8</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]*m.a[ <span class="hljs-number">9</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*m.a[<span class="hljs-number">10</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">12</span>]*m.a[<span class="hljs-number">11</span>]
    a.a[ <span class="hljs-number">9</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*m.a[ <span class="hljs-number">8</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]*m.a[ <span class="hljs-number">9</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">9</span>]*m.a[<span class="hljs-number">10</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">13</span>]*m.a[<span class="hljs-number">11</span>]
    a.a[<span class="hljs-number">10</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*m.a[ <span class="hljs-number">8</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>]*m.a[ <span class="hljs-number">9</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">10</span>]*m.a[<span class="hljs-number">10</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">14</span>]*m.a[<span class="hljs-number">11</span>]
    a.a[<span class="hljs-number">11</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*m.a[ <span class="hljs-number">8</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>]*m.a[ <span class="hljs-number">9</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">11</span>]*m.a[<span class="hljs-number">10</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">15</span>]*m.a[<span class="hljs-number">11</span>]
    
    a.a[<span class="hljs-number">12</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*m.a[<span class="hljs-number">12</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]*m.a[<span class="hljs-number">13</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*m.a[<span class="hljs-number">14</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">12</span>]*m.a[<span class="hljs-number">15</span>]
    a.a[<span class="hljs-number">13</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*m.a[<span class="hljs-number">12</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]*m.a[<span class="hljs-number">13</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">9</span>]*m.a[<span class="hljs-number">14</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">13</span>]*m.a[<span class="hljs-number">15</span>]
    a.a[<span class="hljs-number">14</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*m.a[<span class="hljs-number">12</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>]*m.a[<span class="hljs-number">13</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">10</span>]*m.a[<span class="hljs-number">14</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">14</span>]*m.a[<span class="hljs-number">15</span>]
    a.a[<span class="hljs-number">15</span>] = <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*m.a[<span class="hljs-number">12</span>] + <span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>]*m.a[<span class="hljs-number">13</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">11</span>]*m.a[<span class="hljs-number">14</span>] + <span class="hljs-property">@a</span>[<span class="hljs-number">15</span>]*m.a[<span class="hljs-number">15</span>]

    <span class="hljs-property">@copy</span>(a)
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>flatten</strong> - return the array part of this matrix</p></div></div><div class="code"><div class="wrapper">  flatten :<span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-property">@a</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>multVec</strong> - multiply vector v by this matrix - destructive to v</p>
<ul>
<li><strong>v</strong> - Vec4</li>
<li>returns</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">multVec</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> v.z?
      PXLWarning <span class="hljs-string">"Mismatched vector and matrix dimensions"</span>
      <span class="hljs-keyword">return</span>

    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> v.w?
      x = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*v.x + <span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]*v.y + <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*v.z + <span class="hljs-property">@a</span>[<span class="hljs-number">12</span>]
      y = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*v.x + <span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]*v.y + <span class="hljs-property">@a</span>[ <span class="hljs-number">9</span>]*v.z + <span class="hljs-property">@a</span>[<span class="hljs-number">13</span>]
      z = <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*v.x + <span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>]*v.y + <span class="hljs-property">@a</span>[<span class="hljs-number">10</span>]*v.z + <span class="hljs-property">@a</span>[<span class="hljs-number">14</span>]
      w = <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*v.x + <span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>]*v.y + <span class="hljs-property">@a</span>[<span class="hljs-number">11</span>]*v.z + <span class="hljs-property">@a</span>[<span class="hljs-number">15</span>]
      v.x = x/w
      v.y = y/w
      v.z = z/w
    <span class="hljs-keyword">else</span>
      x = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*v.x + <span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]*v.y + <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*v.z + <span class="hljs-property">@a</span>[<span class="hljs-number">12</span>] * v.w
      y = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*v.x + <span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]*v.y + <span class="hljs-property">@a</span>[ <span class="hljs-number">9</span>]*v.z + <span class="hljs-property">@a</span>[<span class="hljs-number">13</span>] * v.w
      z = <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*v.x + <span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>]*v.y + <span class="hljs-property">@a</span>[<span class="hljs-number">10</span>]*v.z + <span class="hljs-property">@a</span>[<span class="hljs-number">14</span>] * v.w
      w = <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*v.x + <span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>]*v.y + <span class="hljs-property">@a</span>[<span class="hljs-number">11</span>]*v.z + <span class="hljs-property">@a</span>[<span class="hljs-number">15</span>] * v.w
      v.x = x
      v.y = y
      v.z = z
      v.w = w
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>at</strong> - return the number at row r and column c</p>
<ul>
<li><strong>r</strong> - Number</li>
<li><strong>c</strong> - Number</li>
<li>returns Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">at</span>: <span class="hljs-function"><span class="hljs-params">(r,c)</span> -&gt;</span>
    <span class="hljs-property">@a</span>[c * <span class="hljs-number">4</span> + r]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>getCol</strong> - return a column from this matrix as a Vec4</p>
<ul>
<li><strong>c</strong> - Number</li>
<li>returns Vec4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">getCol</span>: <span class="hljs-function"><span class="hljs-params">(c)</span>-&gt;</span>
    c = c * <span class="hljs-number">4</span>
    Vec4 <span class="hljs-property">@a</span>[c + <span class="hljs-number">0</span>] <span class="hljs-property">@a</span>[c + <span class="hljs-number">1</span>] <span class="hljs-property">@a</span>[c + <span class="hljs-number">2</span>] <span class="hljs-property">@a</span>[c + <span class="hljs-number">3</span>]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>getRow</strong> - return a row from this matrix as a Vec4</p>
<ul>
<li><strong>r</strong> - Number</li>
<li>returns Vec4</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">getRow</span>: <span class="hljs-function"><span class="hljs-params">(r)</span> -&gt;</span>
    Vec4 <span class="hljs-property">@a</span>[r + <span class="hljs-number">0</span>] <span class="hljs-property">@a</span>[r + <span class="hljs-number">4</span>] <span class="hljs-property">@a</span>[r + <span class="hljs-number">8</span>] <span class="hljs-property">@a</span>[r + <span class="hljs-number">12</span>]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>_invert</strong> - internal</p></div></div><div class="code"><div class="wrapper">  _invert : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>

    inv = <span class="hljs-keyword">new</span> Matrix4()
    epsilon = <span class="hljs-number">4.37114e-05</span>

    a0 = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*<span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>] - <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*<span class="hljs-property">@a</span>[<span class="hljs-number">4</span>]
    a1 = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*<span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>] - <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*<span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]
    a2 = <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*<span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>] - <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*<span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]
    a3 = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*<span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>] - <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*<span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]
    a4 = <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*<span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>] - <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*<span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]
    a5 = <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*<span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>] - <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*<span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>]
    b0 = <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*<span class="hljs-property">@a</span>[<span class="hljs-number">13</span>] - <span class="hljs-property">@a</span>[ <span class="hljs-number">9</span>]*<span class="hljs-property">@a</span>[<span class="hljs-number">12</span>]
    b1 = <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*<span class="hljs-property">@a</span>[<span class="hljs-number">14</span>] - <span class="hljs-property">@a</span>[<span class="hljs-number">10</span>]*<span class="hljs-property">@a</span>[<span class="hljs-number">12</span>]
    b2 = <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*<span class="hljs-property">@a</span>[<span class="hljs-number">15</span>] - <span class="hljs-property">@a</span>[<span class="hljs-number">11</span>]*<span class="hljs-property">@a</span>[<span class="hljs-number">12</span>]
    b3 = <span class="hljs-property">@a</span>[ <span class="hljs-number">9</span>]*<span class="hljs-property">@a</span>[<span class="hljs-number">14</span>] - <span class="hljs-property">@a</span>[<span class="hljs-number">10</span>]*<span class="hljs-property">@a</span>[<span class="hljs-number">13</span>]
    b4 = <span class="hljs-property">@a</span>[ <span class="hljs-number">9</span>]*<span class="hljs-property">@a</span>[<span class="hljs-number">15</span>] - <span class="hljs-property">@a</span>[<span class="hljs-number">11</span>]*<span class="hljs-property">@a</span>[<span class="hljs-number">13</span>]
    b5 = <span class="hljs-property">@a</span>[<span class="hljs-number">10</span>]*<span class="hljs-property">@a</span>[<span class="hljs-number">15</span>] - <span class="hljs-property">@a</span>[<span class="hljs-number">11</span>]*<span class="hljs-property">@a</span>[<span class="hljs-number">14</span>]

    det = a0*b5 - a1*b4 + a2*b3 + a3*b2 - a4*b1 + a5*b0

    <span class="hljs-keyword">if</span>  Math.abs( det ) &gt; epsilon
      inv.a[ <span class="hljs-number">0</span>] = + <span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]*b5 - <span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>]*b4 + <span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>]*b3
      inv.a[ <span class="hljs-number">4</span>] = - <span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]*b5 + <span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>]*b2 - <span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>]*b1
      inv.a[ <span class="hljs-number">8</span>] = + <span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]*b4 - <span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]*b2 + <span class="hljs-property">@a</span>[ <span class="hljs-number">7</span>]*b0
      inv.a[<span class="hljs-number">12</span>] = - <span class="hljs-property">@a</span>[ <span class="hljs-number">4</span>]*b3 + <span class="hljs-property">@a</span>[ <span class="hljs-number">5</span>]*b1 - <span class="hljs-property">@a</span>[ <span class="hljs-number">6</span>]*b0
      inv.a[ <span class="hljs-number">1</span>] = - <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*b5 + <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*b4 - <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*b3
      inv.a[ <span class="hljs-number">5</span>] = + <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*b5 - <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*b2 + <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*b1
      inv.a[ <span class="hljs-number">9</span>] = - <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*b4 + <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*b2 - <span class="hljs-property">@a</span>[ <span class="hljs-number">3</span>]*b0
      inv.a[<span class="hljs-number">13</span>] = + <span class="hljs-property">@a</span>[ <span class="hljs-number">0</span>]*b3 - <span class="hljs-property">@a</span>[ <span class="hljs-number">1</span>]*b1 + <span class="hljs-property">@a</span>[ <span class="hljs-number">2</span>]*b0
      inv.a[ <span class="hljs-number">2</span>] = + <span class="hljs-property">@a</span>[<span class="hljs-number">13</span>]*a5 - <span class="hljs-property">@a</span>[<span class="hljs-number">14</span>]*a4 + <span class="hljs-property">@a</span>[<span class="hljs-number">15</span>]*a3
      inv.a[ <span class="hljs-number">6</span>] = - <span class="hljs-property">@a</span>[<span class="hljs-number">12</span>]*a5 + <span class="hljs-property">@a</span>[<span class="hljs-number">14</span>]*a2 - <span class="hljs-property">@a</span>[<span class="hljs-number">15</span>]*a1
      inv.a[<span class="hljs-number">10</span>] = + <span class="hljs-property">@a</span>[<span class="hljs-number">12</span>]*a4 - <span class="hljs-property">@a</span>[<span class="hljs-number">13</span>]*a2 + <span class="hljs-property">@a</span>[<span class="hljs-number">15</span>]*a0
      inv.a[<span class="hljs-number">14</span>] = - <span class="hljs-property">@a</span>[<span class="hljs-number">12</span>]*a3 + <span class="hljs-property">@a</span>[<span class="hljs-number">13</span>]*a1 - <span class="hljs-property">@a</span>[<span class="hljs-number">14</span>]*a0
      inv.a[ <span class="hljs-number">3</span>] = - <span class="hljs-property">@a</span>[ <span class="hljs-number">9</span>]*a5 + <span class="hljs-property">@a</span>[<span class="hljs-number">10</span>]*a4 - <span class="hljs-property">@a</span>[<span class="hljs-number">11</span>]*a3
      inv.a[ <span class="hljs-number">7</span>] = + <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*a5 - <span class="hljs-property">@a</span>[<span class="hljs-number">10</span>]*a2 + <span class="hljs-property">@a</span>[<span class="hljs-number">11</span>]*a1
      inv.a[<span class="hljs-number">11</span>] = - <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*a4 + <span class="hljs-property">@a</span>[ <span class="hljs-number">9</span>]*a2 - <span class="hljs-property">@a</span>[<span class="hljs-number">11</span>]*a0
      inv.a[<span class="hljs-number">15</span>] = + <span class="hljs-property">@a</span>[ <span class="hljs-number">8</span>]*a3 - <span class="hljs-property">@a</span>[ <span class="hljs-number">9</span>]*a1 + <span class="hljs-property">@a</span>[<span class="hljs-number">10</span>]*a0

    invDet = <span class="hljs-number">1.0</span>/det

    inv.multScalar(invDet)
    inv</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>invert</strong> - invert this matrix</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">invert</span>: <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-property">@copy</span> <span class="hljs-property">@_invert</span>() 
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>transpose</strong> - transpose this matrix</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  transpose : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-property">@copy</span> <span class="hljs-keyword">new</span> Matrix4( [ <span class="hljs-property">@a</span>[<span class="hljs-number">0</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">4</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">8</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">12</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">1</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">5</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">9</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">13</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">2</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">6</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">10</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">14</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">3</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">7</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">11</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">15</span>] ] )
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>translate</strong> - multiple this matrix by a translation matrix, formed from the Vec3 v</p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">translate</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> v.DIM?
      <span class="hljs-keyword">if</span> v.DIM != <span class="hljs-number">3</span>
        PXLWarning <span class="hljs-string">"Mismatched vector and matrix dimensions"</span>
        <span class="hljs-keyword">return</span> @

    r = <span class="hljs-keyword">new</span> Matrix4()
    r.a[<span class="hljs-number">12</span>] = v.x
    r.a[<span class="hljs-number">13</span>] = v.y
    r.a[<span class="hljs-number">14</span>] = v.z
    <span class="hljs-property">@mult</span>(r)
      
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>translatePart</strong> - set the translation part of this matrixfrom the Vec3 v</p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">translatePart</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> v.DIM?
      <span class="hljs-keyword">if</span> v.DIM != <span class="hljs-number">3</span>
        PXLWarning <span class="hljs-string">"Mismatched vector and matrix dimensions"</span>
        <span class="hljs-keyword">return</span> @

    <span class="hljs-property">@a</span>[<span class="hljs-number">12</span>] = v.x
    <span class="hljs-property">@a</span>[<span class="hljs-number">13</span>] = v.y
    <span class="hljs-property">@a</span>[<span class="hljs-number">14</span>] = v.z
      
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>setPos</strong> - Given a vector, sets the translation part of the matrix directly with no multiplication</p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  setPos : <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
    <span class="hljs-property">@a</span>[<span class="hljs-number">12</span>] = v.x <span class="hljs-keyword">if</span> v.x?
    <span class="hljs-property">@a</span>[<span class="hljs-number">13</span>] = v.y <span class="hljs-keyword">if</span> v.y?
    <span class="hljs-property">@a</span>[<span class="hljs-number">14</span>] = v.z <span class="hljs-keyword">if</span> v.z?
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>getPos</strong> - return the translation component as a Vec3</p>
<ul>
<li>returns new Vec3</li>
</ul></div></div><div class="code"><div class="wrapper">  getPos : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Vec3 <span class="hljs-property">@a</span>[<span class="hljs-number">12</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">13</span>],<span class="hljs-property">@a</span>[<span class="hljs-number">14</span>]
  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>print</strong> - print this matrix to the console</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">print</span>: <span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span>
    <span class="hljs-built_in">console</span>.log <span class="hljs-property">@a</span>[<span class="hljs-number">0</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">4</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">8</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">12</span>]
    <span class="hljs-built_in">console</span>.log <span class="hljs-property">@a</span>[<span class="hljs-number">1</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">5</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">9</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">13</span>]
    <span class="hljs-built_in">console</span>.log <span class="hljs-property">@a</span>[<span class="hljs-number">2</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">6</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">10</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">14</span>]
    <span class="hljs-built_in">console</span>.log <span class="hljs-property">@a</span>[<span class="hljs-number">3</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">7</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">11</span>] + <span class="hljs-string">","</span> + <span class="hljs-property">@a</span>[<span class="hljs-number">15</span>]
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>lookAt</strong> - similar to gluLookAt - creates a matrix from an eye, look and up vector</p>
<ul>
<li><strong>eye</strong> - Vec3</li>
<li><strong>look</strong> - Vec3</li>
<li><strong>up</strong> - Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">lookAt</span>: <span class="hljs-function"><span class="hljs-params">(eye,look,up)</span> -&gt;</span>

    f = Vec3.sub(look,eye)
    f.normalize()
    u = up.clone()
    u.normalize()

    s = Vec3.cross(f,u)
    w = Vec3.cross(s,f)

    m = <span class="hljs-keyword">new</span> Matrix4([s.x,u.x,-f.x,<span class="hljs-number">0</span>,s.y,u.y,-f.y,<span class="hljs-number">0</span>,s.z,u.z,-f.z,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>])
    t = <span class="hljs-keyword">new</span> Matrix4([<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>, -eye.x,-eye.y,-eye.z,<span class="hljs-number">1</span>])

    m.mult(t)
    <span class="hljs-property">@copy</span>(m)
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>makePerspective</strong> - given a field-of-view in degrees, an aspect ratio (w/h) and near and far clip planes
create a perspective matrix</p>
<ul>
<li><strong>fovy</strong> - Number</li>
<li><strong>aspect</strong> - Number</li>
<li><strong>znear</strong> - Number</li>
<li><strong>zfar</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">makePerspective</span>: <span class="hljs-function"><span class="hljs-params">(fovy,aspect,znear,zfar)</span> -&gt;</span>
    ymax = znear * Math.tan(fovy)
    ymin = -ymax;
    xmin = ymin * aspect
    xmax = ymax * aspect
    <span class="hljs-property">@makeFrustum</span>(xmin, xmax, ymin, ymax, znear, zfar)
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>makeFrustum</strong> - used by makePerspective to create our frustrum</p>
<ul>
<li><strong>left</strong> - Number</li>
<li><strong>right</strong> - Number</li>
<li><strong>bottom</strong> - Number</li>
<li><strong>top</strong> - Number</li>
<li><strong>znear</strong> - Number</li>
<li><strong>zfar</strong> - Number  </li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">makeFrustum</span>: <span class="hljs-function"><span class="hljs-params">(left, right, bottom, top, znear, zfar)</span> -&gt;</span>
    x = <span class="hljs-number">2</span>*znear/(right-left)
    y = <span class="hljs-number">2</span>*znear/(top-bottom)
    a = (right+left)/(right-left)
    b = (top+bottom)/(top-bottom)
    c = -(zfar+znear)/(zfar-znear)
    d = -<span class="hljs-number">2</span>*zfar*znear/(zfar-znear)
    <span class="hljs-property">@a</span> = <span class="hljs-keyword">new</span> glMatrixArrayType([x,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,y,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,a,b,c,-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,d,<span class="hljs-number">0</span>])
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>makeOrtho</strong> - given left,right,bottom,top, near and far floats, create an orthographic projection</p>
<ul>
<li><strong>left</strong> - Number</li>
<li><strong>right</strong> - Number</li>
<li><strong>bottom</strong> - Number</li>
<li><strong>top</strong> - Number</li>
<li><strong>znear</strong> - Number</li>
<li><strong>zfar</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">makeOrtho</span>: <span class="hljs-function"><span class="hljs-params">(left, right, bottom, top, znear, zfar)</span> -&gt;</span>
    tx = - (right + left) / (right - left)
    ty = - (top + bottom) / (top - bottom)
    tz = - (zfar + znear) / (zfar - znear)
    <span class="hljs-property">@a</span> = <span class="hljs-keyword">new</span> glMatrixArrayType([<span class="hljs-number">2</span> / (right - left),<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>, <span class="hljs-number">2</span> / (top-bottom),<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>, -<span class="hljs-number">2</span> / (zfar - znear),<span class="hljs-number">0</span>,tx,ty,tz,<span class="hljs-number">1</span>])
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>rotate</strong> - given a vector and an angle (radians), create the rotation part of this matrix</p>
<ul>
<li><strong>v</strong> - a Vec3</li>
<li><strong>a</strong> - a Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">rotate</span>: <span class="hljs-function"><span class="hljs-params">(v,a)</span> -&gt;</span>

    r = <span class="hljs-keyword">new</span> Matrix4()
    s = Math.sin(a)
    c = Math.cos(a)
    v.normalize()

    r.a[<span class="hljs-number">0</span>] = v.x * v.x * (<span class="hljs-number">1</span>-c) + c
    r.a[<span class="hljs-number">1</span>] = v.x * v.y * (<span class="hljs-number">1</span>-c) + v.z * s
    r.a[<span class="hljs-number">2</span>] = v.x * v.z * (<span class="hljs-number">1</span>-c) - v.y * s
    
    r.a[<span class="hljs-number">4</span>] = v.x * v.y * (<span class="hljs-number">1</span>-c) - v.z * s
    r.a[<span class="hljs-number">5</span>] = v.y * v.y * (<span class="hljs-number">1</span>-c) + c
    r.a[<span class="hljs-number">6</span>] = v.y * v.z * (<span class="hljs-number">1</span>-c) + v.x * s

    r.a[<span class="hljs-number">8</span>] = v.x * v.z * (<span class="hljs-number">1</span>-c) + v.y * s
    r.a[<span class="hljs-number">9</span>] = v.y * v.z * (<span class="hljs-number">1</span>-c) - v.x * s
    r.a[<span class="hljs-number">10</span>]= v.z * v.z * (<span class="hljs-number">1</span>-c) + c
  
    <span class="hljs-property">@mult</span>(r)
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>scale</strong> - scale our matrix by a Vec3 </p>
<ul>
<li><strong>v</strong> - a Vec3</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">scale</span>: <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Leave w</p></div></div><div class="code"><div class="wrapper">    r = <span class="hljs-keyword">new</span> Matrix4()
    r.a[<span class="hljs-number">0</span>] = v.x
    r.a[<span class="hljs-number">5</span>] = v.y
    r.a[<span class="hljs-number">10</span>] = v.z
    <span class="hljs-property">@mult</span>(r)
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="quaternion">Quaternion</h2>
<p>A quaternion to deal with all our rotations</p></div></div><div class="code"><div class="wrapper"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Quaternion</span></span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@addScalar</strong> - static function - add a scalar to every element in this quaternion</p>
<ul>
<li><strong>a</strong> - a Quaternion</li>
<li><strong>b</strong> - a Number</li>
<li>returns a new Quaternion</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@addScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"addScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@subScalar</strong> - static function - subtract a scalar from every element in this quaternion</p>
<ul>
<li><strong>a</strong> - a Quaternion</li>
<li><strong>b</strong> - a Number</li>
<li>returns a new Quaternion</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@subScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"subScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@multScalar</strong> - static function - multiply every element in this quaternion by a scalar</p>
<ul>
<li><strong>a</strong> - a Quaternion</li>
<li><strong>b</strong> - a Number</li>
<li>returns a new Quaternion </li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@multScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"multScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@divScalar</strong> - static function - divide every element in this quaternion by a scalar</p>
<ul>
<li><strong>a</strong> - a Quaternion</li>
<li><strong>b</strong> - a Number</li>
<li>returns a new Quaternion</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@divScalar</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"divScalar"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@conjugate</strong> - static function - return the conjugate to this quaternion</p>
<ul>
<li><strong>a</strong> - a Quaternion</li>
<li>returns a new Quaternion</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@conjugate</span>:<span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"conjugate"</span>]()</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@mult</strong> - static function - multiply this quaternion by another quaternion</p>
<ul>
<li><strong>a</strong> - a Quaternion</li>
<li><strong>b</strong> - a Quaternion</li>
<li>returns a new Quaternion</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@mult</span>:<span class="hljs-function"><span class="hljs-params">(a,b)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"mult"</span>](b)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>@invert</strong> - static function - return an inverted version</p>
<ul>
<li><strong>a</strong> - a Quaternion</li>
<li>returns a new Quaternion</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@invert</span>:<span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    a.clone()[<span class="hljs-string">"invert"</span>]()
 </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>transVec3</strong> - static function - given a vector, return a new version of it, transformed by this quaternion</p>
<ul>
<li><strong>q</strong> - Quaternion</li>
<li><strong>v</strong> - Vec3</li>
<li>returns a new Vec3 </li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@transVec3</span>:<span class="hljs-function"><span class="hljs-params">(q,v)</span> -&gt;</span>
    tv = v.clone()
    q.transVec3(tv)
    tv</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>fromRotations</strong> - static function - create a Quaternion from x, y and z rotations in radians.</p>
<ul>
<li><strong>x</strong> - Number</li>
<li><strong>y</strong> - Number</li>
<li><strong>z</strong> - Number</li>
<li>returns a new Quaternion</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@fromRotations</span> : <span class="hljs-function"><span class="hljs-params">(x,y,z)</span> -&gt;</span>
    tv = <span class="hljs-keyword">new</span> Quaternion()
    tv.fromRotations x,y,z
    tv</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>fromTo</strong> - static function - given two quaternions, return a new one from the first to the second</p>
<ul>
<li><strong>f</strong> - Quaternion</li>
<li><strong>t</strong> - Quaternion</li>
<li>returns a new Quaternion</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-property">@fromTo</span>: <span class="hljs-function"><span class="hljs-params">(f,t)</span> -&gt;</span>
    tv = <span class="hljs-keyword">new</span> Quaternion()
    tv.fromTo(f,t)
    tv
  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>constructor</strong> - takes three axis numbers and a w</p>
<ul>
<li><strong>x</strong> - Number - optional - default 0</li>
<li><strong>y</strong> - Number - optional - default 0</li>
<li><strong>z</strong> - Number - optional - default 0</li>
<li><strong>w</strong> - Number - optional - default 1</li>
</ul></div></div><div class="code"><div class="wrapper">  constructor : <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@x</span>, <span class="hljs-property">@y</span>, <span class="hljs-property">@z</span>, <span class="hljs-property">@w</span>)</span> -&gt;</span>
    <span class="hljs-property">@x</span> = <span class="hljs-number">0</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-property">@x</span>?
    <span class="hljs-property">@y</span> = <span class="hljs-number">0</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-property">@y</span>?
    <span class="hljs-property">@z</span> = <span class="hljs-number">0</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-property">@z</span>?
    <span class="hljs-property">@w</span> = <span class="hljs-number">1</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-property">@w</span>?</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>clone</strong> - return a coy of this Quaternion</p>
<ul>
<li>returns a new Quaternion</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">clone</span>: <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-keyword">new</span> Quaternion <span class="hljs-property">@x</span>, <span class="hljs-property">@y</span>, <span class="hljs-property">@z</span>, <span class="hljs-property">@w</span>
 </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>copy</strong> - copy another quaternion into this one</p>
<ul>
<li><strong>q</strong> - Quaternion</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">copy</span>: <span class="hljs-function"><span class="hljs-params">(q)</span> -&gt;</span>
    <span class="hljs-property">@x</span> = q.x
    <span class="hljs-property">@y</span> = q.y
    <span class="hljs-property">@z</span> = q.z
    <span class="hljs-property">@w</span> = q.w
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>axis</strong> - return the axis of this Quaternion </p>
<ul>
<li>returns a new Vec3</li>
</ul></div></div><div class="code"><div class="wrapper">  axis : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    ca = <span class="hljs-property">@w</span>
    invlen = <span class="hljs-number">1.0</span>/ Math.sqrt(<span class="hljs-number">1.0</span> - ca * ca)
    x *= invlen
    y *= invlen
    z *= invlen
    <span class="hljs-keyword">new</span> Vec3(x,y,z)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>angle</strong> - return the angle of this Quaternion</p>
<ul>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  angle : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    Math.acos(<span class="hljs-property">@w</span>) * <span class="hljs-number">2</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>pitch</strong> - return the pitch of this Quaternion</p>
<ul>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  pitch : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    Math.atan2(<span class="hljs-number">2</span> * (<span class="hljs-property">@y</span> * <span class="hljs-property">@z</span> + <span class="hljs-property">@w</span> * <span class="hljs-property">@x</span> ), <span class="hljs-property">@w</span> * <span class="hljs-property">@w</span> - <span class="hljs-property">@x</span> * <span class="hljs-property">@x</span> - <span class="hljs-property">@y</span> * <span class="hljs-property">@y</span> + <span class="hljs-property">@z</span> * <span class="hljs-property">@z</span> )</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>yaw</strong> - return the pitch of this Quaternion</p>
<ul>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  yaw : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    Math.sin(-<span class="hljs-number">2</span> * ( <span class="hljs-property">@x</span> * <span class="hljs-property">@z</span> - <span class="hljs-property">@w</span> * <span class="hljs-property">@y</span> ))</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>roll</strong> - return the pitch of this Quaternion</p>
<ul>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">roll</span>: <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    Math.atan2(<span class="hljs-number">2</span> * ( <span class="hljs-property">@x</span> * <span class="hljs-property">@y</span> + <span class="hljs-property">@w</span> * <span class="hljs-property">@z</span>), <span class="hljs-property">@w</span> * <span class="hljs-property">@w</span> + <span class="hljs-property">@x</span> * <span class="hljs-property">@x</span> - <span class="hljs-property">@y</span> * <span class="hljs-property">@y</span> - <span class="hljs-property">@z</span> * <span class="hljs-property">@z</span>)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>dot</strong> - return the dot product of this Quaternion with another</p>
<ul>
<li><strong>a</strong> - Quaternion</li>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  dot : <span class="hljs-function"><span class="hljs-params">(a)</span> -&gt;</span>
    <span class="hljs-property">@w</span> * a.w + <span class="hljs-property">@x</span> * a.x + <span class="hljs-property">@y</span> * a.y + <span class="hljs-property">@z</span> * a.z</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>length</strong> - return the length of this Quaternion</p>
<ul>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  length : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    Math.sqrt <span class="hljs-property">@lengthSquared</span>()
  </div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>lengthSquared</strong> - return the lengthSquared of this Quaternion</p>
<ul>
<li>returns a Number</li>
</ul></div></div><div class="code"><div class="wrapper">  lengthSquared : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-property">@w</span> * <span class="hljs-property">@w</span> + <span class="hljs-property">@x</span> * <span class="hljs-property">@x</span> + <span class="hljs-property">@y</span> * <span class="hljs-property">@y</span> + <span class="hljs-property">@z</span> * <span class="hljs-property">@z</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>Conjugate</strong></p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  conjugate : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    <span class="hljs-property">@x</span> = -<span class="hljs-property">@x</span>
    <span class="hljs-property">@y</span> = -<span class="hljs-property">@y</span>
    <span class="hljs-property">@z</span> = -<span class="hljs-property">@z</span>
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>invert</strong> - invert this quaternion</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  invert : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    q = Quaternion.conjugate(@)
    q = q.multScalar(<span class="hljs-number">1.0</span> / <span class="hljs-property">@lengthSquared</span>())
    <span class="hljs-property">@x</span> = q.x
    <span class="hljs-property">@y</span> = q.y
    <span class="hljs-property">@z</span> = q.z
    <span class="hljs-property">@w</span> = q.w
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>add</strong> - Add another quaternion to this one</p>
<ul>
<li><strong>q</strong> - Quaternion</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  add : <span class="hljs-function"><span class="hljs-params">(q)</span> -&gt;</span>
    <span class="hljs-property">@w</span> += q.w
    <span class="hljs-property">@x</span> += q.x
    <span class="hljs-property">@y</span> += q.y
    <span class="hljs-property">@z</span> += q.z
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>sub</strong> - Subtract another quaternion from this one</p>
<ul>
<li><strong>q</strong> - Quaternion</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  sub : <span class="hljs-function"><span class="hljs-params">(q)</span> -&gt;</span>
    <span class="hljs-property">@w</span> -= q.w
    <span class="hljs-property">@x</span> -= q.x
    <span class="hljs-property">@y</span> -= q.y
    <span class="hljs-property">@z</span> -= q.z
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>multiply</strong> - multiply this Quaternion with another</p>
<ul>
<li><strong>q</strong> - Quaternion</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  multiply : <span class="hljs-function"><span class="hljs-params">(q)</span> -&gt;</span>
    <span class="hljs-property">@mult</span>(q)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>mult</strong> - multiply this Quaternion with another</p>
<ul>
<li><strong>q</strong> - Quaternion</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="hljs-attribute">mult</span>: <span class="hljs-function"><span class="hljs-params">(q)</span> -&gt;</span>
    w = -<span class="hljs-property">@x</span> * q.x - <span class="hljs-property">@y</span> * q.y - <span class="hljs-property">@z</span> * q.z + <span class="hljs-property">@w</span> * q.w
    x = <span class="hljs-property">@x</span> * q.w + <span class="hljs-property">@y</span> * q.z - <span class="hljs-property">@z</span> * q.y + <span class="hljs-property">@w</span> * q.x
    y = -<span class="hljs-property">@x</span> * q.z + <span class="hljs-property">@y</span> * q.w + <span class="hljs-property">@z</span> * q.x + <span class="hljs-property">@w</span> * q.y
    z = <span class="hljs-property">@x</span> * q.y - <span class="hljs-property">@y</span> * q.x + <span class="hljs-property">@z</span> * q.w + <span class="hljs-property">@w</span> * q.z
    <span class="hljs-property">@w</span> = w
    <span class="hljs-property">@x</span> = x
    <span class="hljs-property">@y</span> = y
    <span class="hljs-property">@z</span> = z
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>multScalar</strong> - multiply this Quaternion by a scalar</p>
<ul>
<li><strong>s</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  multScalar : <span class="hljs-function"><span class="hljs-params">(s)</span> -&gt;</span>
    <span class="hljs-property">@w</span> *= s
    <span class="hljs-property">@x</span> *= s
    <span class="hljs-property">@y</span> *= s
    <span class="hljs-property">@z</span> *= s
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>transVec3</strong> - Transform a vector by this quaternion</p>
<ul>
<li><strong>v</strong> - Vec3</li>
<li>returns this</li>
</ul></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>TODO - this appears to rotate a vector in the opposite direction to glm and other libs
We should check the maths on this one</p></div></div><div class="code"><div class="wrapper">  transVec3 : <span class="hljs-function"><span class="hljs-params">(v)</span> -&gt;</span>
  
    qc = Quaternion.conjugate @
    vp = <span class="hljs-keyword">new</span> Quaternion(v.x, v.y, v.z, <span class="hljs-number">0</span>)

    vf = qc.mult(vp).mult(@)
    v.x = vf.x
    v.y = vf.y
    v.z = vf.z

    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>normalize</strong> - normalize this quaternion</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  normalize : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    len = <span class="hljs-number">1.0</span> / <span class="hljs-property">@length</span>()
    <span class="hljs-property">@w</span> *= len
    <span class="hljs-property">@x</span> *= len
    <span class="hljs-property">@y</span> *= len
    <span class="hljs-property">@z</span> *= len
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>log</strong> - ?</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  log : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    t = <span class="hljs-number">1.0</span>
    <span class="hljs-keyword">if</span> <span class="hljs-property">@w</span> &lt; t
      t = <span class="hljs-property">@w</span>
    
    theta = Math.acos(t)
    <span class="hljs-keyword">if</span> theta == <span class="hljs-number">0</span>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Quaternion(<span class="hljs-property">@x</span>, <span class="hljs-property">@y</span>, <span class="hljs-property">@z</span> ,<span class="hljs-number">0</span>)

    sintheta = Math.sin(theta)
    k = theta / sintheta
    <span class="hljs-keyword">if</span> Math.abs(sintheta) &lt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> Math.abs(theta) &gt;= <span class="hljs-number">3.402823466e+38</span> * Math.abs(sintheta)
      k  =<span class="hljs-number">1</span>

    <span class="hljs-property">@x</span> = <span class="hljs-property">@x</span>*k
    <span class="hljs-property">@y</span> = <span class="hljs-property">@y</span>*k
    <span class="hljs-property">@z</span> = <span class="hljs-property">@z</span>*k
    <span class="hljs-property">@w</span> = <span class="hljs-number">0</span>
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>exp</strong> - ?</p>
<ul>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  exp : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>

    theta = <span class="hljs-property">@v</span>.length()
    sintheta = sin(theta)
    k = sintheta / theta

    <span class="hljs-keyword">if</span> Math.abs(theta) &lt; <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> Math.abs(sintheta) &gt;= <span class="hljs-number">3.402823466e+38</span> * Math.abs(theta)
      k  =<span class="hljs-number">1</span>

    costheta = Math.cos(theta)
  
    <span class="hljs-property">@x</span> = <span class="hljs-property">@x</span> * k
    <span class="hljs-property">@y</span> = <span class="hljs-property">@y</span> * k
    <span class="hljs-property">@z</span> = <span class="hljs-property">@z</span> * k
    <span class="hljs-property">@w</span> = costheta</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>fromTo</strong> - set this quaternion to represent the movement from quaternion to another</p>
<ul>
<li><strong>f</strong> - Quaternion</li>
<li><strong>t</strong> - Quaternion</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  fromTo : <span class="hljs-function"><span class="hljs-params">(f,t)</span> -&gt;</span>
    axis = Vec3.cross(f,t)
    <span class="hljs-property">@w</span> = f.dot(t)
    <span class="hljs-property">@x</span> = axis.x
    <span class="hljs-property">@y</span> = axis.y
    <span class="hljs-property">@z</span> = axis.z
    <span class="hljs-property">@normalize</span>()
    <span class="hljs-property">@w</span> += <span class="hljs-number">1.0</span>

    <span class="hljs-keyword">if</span> <span class="hljs-property">@w</span> &lt;= EPSILON
      <span class="hljs-keyword">if</span> f.z * f.z &gt; f.x * f.x
        <span class="hljs-property">@w</span> = <span class="hljs-number">0.0</span>
        <span class="hljs-property">@x</span> = <span class="hljs-number">0</span>
        <span class="hljs-property">@y</span> = f.z
        <span class="hljs-property">@z</span> = -f.y
      <span class="hljs-keyword">else</span>
        <span class="hljs-property">@w</span> = <span class="hljs-number">0.0</span>
        <span class="hljs-property">@x</span> = f.y
        <span class="hljs-property">@y</span> = -f.x
        <span class="hljs-property">@z</span> = <span class="hljs-number">0.0</span>
      <span class="hljs-property">@normalize</span>()
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>fromAxisAngle</strong> - create a quaternion that represents rotation around an axis in radians</p>
<ul>
<li><strong>a</strong> - Vec3</li>
<li><strong>r</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  fromAxisAngle : <span class="hljs-function"><span class="hljs-params">(a,r)</span> -&gt;</span>
    <span class="hljs-property">@w</span> = Math.cos(r / <span class="hljs-number">2</span>)
    v = <span class="hljs-keyword">new</span> Vec3(a.x,a.y,a.z)
    v.normalize().multScalar(Math.sin(r/<span class="hljs-number">2</span>))
    <span class="hljs-property">@x</span> = v.x
    <span class="hljs-property">@y</span> = v.y
    <span class="hljs-property">@z</span> = v.z
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>fromRotations</strong> - create a Quaternion from rotations around z,y,and x in that order in radians</p>
<ul>
<li><strong>x</strong> - Number</li>
<li><strong>y</strong> - Number</li>
<li><strong>z</strong> - Number</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  fromRotations : <span class="hljs-function"><span class="hljs-params">(x,y,z)</span> -&gt;</span>
    x *= <span class="hljs-number">0.5</span>
    y *= <span class="hljs-number">0.5</span>
    z *= <span class="hljs-number">0.5</span>

    cx = Math.cos x
    sx = Math.sin x

    cy = Math.cos y
    sy = Math.sin y

    cz = Math.cos z
    sz = Math.sin z

    <span class="hljs-property">@w</span>  = cx * cy * cz - sx * sy * sz
    <span class="hljs-property">@x</span> = sx*cy*cx + cx*sy*sz
    <span class="hljs-property">@y</span> = cx*sy*cz - sx*cy*sz
    <span class="hljs-property">@z</span> = cx*cy*sz + sx*sy*cx
    @</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>getAxisAngle</strong> - return the axis and angle represented by this quaternion</p>
<ul>
<li>returns [Vec3, Number]</li>
</ul></div></div><div class="code"><div class="wrapper">  getAxisAngle : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>
    ca = <span class="hljs-property">@w</span>
    r = Math.acos(ca) * <span class="hljs-number">2</span>
    invlen = <span class="hljs-number">1.0</span> / Math.sqrt(<span class="hljs-number">1.0</span> - ca * ca)

    [<span class="hljs-keyword">new</span> Vec3(<span class="hljs-property">@x</span> * invlen, <span class="hljs-property">@y</span> * invlen, <span class="hljs-property">@z</span> * invlen), r]</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>getMatrix4</strong> - return a matrix4 from this Quaternion</p>
<ul>
<li>returns Matrix4</li>
</ul></div></div><div class="code"><div class="wrapper">  getMatrix4 : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>

    xs = <span class="hljs-property">@x</span> + <span class="hljs-property">@x</span>
    ys = <span class="hljs-property">@y</span> + <span class="hljs-property">@y</span>
    zs = <span class="hljs-property">@z</span> + <span class="hljs-property">@z</span>
    wx = <span class="hljs-property">@w</span> * xs
    wy = <span class="hljs-property">@w</span> * ys
    wz = <span class="hljs-property">@w</span> * zs
    xx = <span class="hljs-property">@x</span> * xs
    xy = <span class="hljs-property">@x</span> * ys
    xz = <span class="hljs-property">@x</span> * zs
    yy = <span class="hljs-property">@y</span> * ys
    yz = <span class="hljs-property">@y</span> * zs
    zz = <span class="hljs-property">@z</span> * zs

    <span class="hljs-keyword">new</span> Matrix4( [<span class="hljs-number">1.0</span> - (yy+zz),
      xy + wz,
      xz - wy,
      <span class="hljs-number">0</span>,
      xy - wz,
      <span class="hljs-number">1.0</span> - ( xx + zz ),
      yz + wx,
      <span class="hljs-number">0</span>,
      xz + wy,
      yz - wx,
      <span class="hljs-number">1.0</span> - ( xx + yy ),
      <span class="hljs-number">0</span>,
      <span class="hljs-number">0</span>,
      <span class="hljs-number">0</span>,
      <span class="hljs-number">0</span>,
      <span class="hljs-number">1.0</span>])</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>getMatrix3</strong> - return a matrix3 from this Quaternion - The rotation component</p>
<ul>
<li>returns Matrix3</li>
</ul></div></div><div class="code"><div class="wrapper">  getMatrix3 : <span class="hljs-function"><span class="hljs-params">()</span> -&gt;</span>

    xs = <span class="hljs-property">@x</span> + <span class="hljs-property">@x</span>
    ys = <span class="hljs-property">@y</span> + <span class="hljs-property">@y</span>
    zs = <span class="hljs-property">@z</span> + <span class="hljs-property">@z</span>
    wx = <span class="hljs-property">@w</span> * xs
    wy = <span class="hljs-property">@w</span> * ys
    wz = <span class="hljs-property">@w</span> * zs
    xx = <span class="hljs-property">@x</span> * xs
    xy = <span class="hljs-property">@x</span> * ys
    xz = <span class="hljs-property">@x</span> * zs
    yy = <span class="hljs-property">@y</span> * ys
    yz = <span class="hljs-property">@y</span> * zs
    zz = <span class="hljs-property">@z</span> * zs

    <span class="hljs-keyword">new</span> Matrix3( [<span class="hljs-number">1.0</span> - (yy+zz),
      xy + wz,
      xz - wy,
      xy - wz,
      <span class="hljs-number">1.0</span> - ( xx + zz ),
      yz + wx,
      xz + wy,
      yz - wx,
      <span class="hljs-number">1.0</span> - ( xx + yy )])</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>lerp</strong> - lerp between this quaternion at the start and the one at the &#39;end&#39;, t being 0-&gt;1</p>
<ul>
<li><strong>t</strong> - Quaternion</li>
<li><strong>end</strong> - Number</li>
<li>returns a new Quaternion</li>
</ul></div></div><div class="code"><div class="wrapper">  lerp : <span class="hljs-function"><span class="hljs-params">(t,end)</span> -&gt;</span>
   
    costheta = end.dot()
    result = Quaternion.multScalar(end,t)
    <span class="hljs-keyword">if</span> costheta &gt;= EPSILON
      result.add (result.multScalar(<span class="hljs-number">1.0</span> - t))
    <span class="hljs-keyword">else</span>
      result.add (result.multScalar(t - <span class="hljs-number">1.0</span>))
    result</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>slerpShortestUnenforced</strong> - slerp between this quaternion at the start and the one at the &#39;end&#39;, t being 0-&gt;1</p>
<ul>
<li><strong>t</strong> - Quaternion</li>
<li><strong>end</strong> - Number</li>
<li>returns a new Quaternion</li>
</ul></div></div><div class="code"><div class="wrapper">  
  slerpShortestUnenforced : <span class="hljs-function"><span class="hljs-params">(t,end)</span> -&gt;</span>
    d = <span class="hljs-property">@clone</span>()
    d.sub(end)
    lengthD = Math.sqrt(<span class="hljs-property">@dot</span>(end))
    st = <span class="hljs-property">@clone</span>()
    st.add(end)
    lengthS = Math.sqrt(st.dot(st))

    a = <span class="hljs-number">2</span> * Math.atan2(lengthD,lengthS)
    s = <span class="hljs-number">1</span> - t

    q = <span class="hljs-property">@clone</span>()
    q.multScalar(( sinx_over_x( s * a ) / sinx_over_x( a ) * s ) )
    e = end.clone()
    e.multScalar(( sinx_over_x( t * a ) / sinx_over_x( a ) * t ))
    q.add(e)
    q.normalize()
    q</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>slerp</strong> - slerp between this quaternion at the start and the one at the &#39;end&#39;, t being 0-&gt;1</p>
<ul>
<li><strong>t</strong> - Quaternion</li>
<li><strong>end</strong> - Number</li>
<li>returns a new Quaternion</li>
</ul></div></div><div class="code"><div class="wrapper">  
  slerp : <span class="hljs-function"><span class="hljs-params">(t,end)</span> -&gt;</span>
    cosTheta = <span class="hljs-property">@dot</span>( end )

    <span class="hljs-keyword">if</span> cosTheta &gt;= EPSILON
      <span class="hljs-keyword">if</span>  <span class="hljs-number">1.0</span>  - cosTheta  &gt; EPSILON
        theta = Math.acos(cosTheta)
        recipSinTheta = <span class="hljs-number">1.0</span> / Math.sin(theta)
        startInterp = Math.sin( (<span class="hljs-number">1.0</span> - t) * theta) * recipSinTheta
        endInterp = Math.sin( t * theta) * recipSinTheta
      <span class="hljs-keyword">else</span>
        startInterp = <span class="hljs-number">1.0</span> - t
        endInterp = t
    <span class="hljs-keyword">else</span> 
      <span class="hljs-keyword">if</span> <span class="hljs-number">1.0</span> + cosTheta &gt; EPSILON
        theta = Math.acos(-cosTheta)
        recipSinTheta = <span class="hljs-number">1.0</span> / Math.sin(theta)
        startInterp = Math.sin((t - <span class="hljs-number">1.0</span>) * theta ) * recipSinTheta
        endInterp = Math.sin(t*theta) * recipSinTheta
      
      <span class="hljs-keyword">else</span>
        startInterp = t -<span class="hljs-number">1.0</span>
        endInterp = t
   
    q = <span class="hljs-property">@clone</span>()
    q.mult(startInterp)
    e = end.clone()
    e.mult(endInterp)
    q.add(e)
    q</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><strong>fromMatrix4</strong> : Create a Quaternion from an existing Matrix4</p>
<ul>
<li><strong>m</strong> - Matrix4</li>
<li>returns this</li>
</ul></div></div><div class="code"><div class="wrapper">  
  fromMatrix4 : <span class="hljs-function"><span class="hljs-params">(m)</span> -&gt;</span>

    trace = m.a[<span class="hljs-number">0</span>] + m.a[<span class="hljs-number">5</span>] + m.a[<span class="hljs-number">10</span>]

    <span class="hljs-keyword">if</span>  trace &gt; <span class="hljs-number">0.0</span>
      s = Math.sqrt(trace + <span class="hljs-number">1.0</span>)
      <span class="hljs-property">@w</span> = s * <span class="hljs-number">0.5</span>
      recip = <span class="hljs-number">0.5</span> / s

      <span class="hljs-property">@x</span> = ( m.at(<span class="hljs-number">2</span>,<span class="hljs-number">1</span>) - m.at(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>) ) * recip
      <span class="hljs-property">@y</span> = ( m.at(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>) - m.at(<span class="hljs-number">2</span>,<span class="hljs-number">0</span>) ) * recip
      <span class="hljs-property">@z</span> = ( m.at(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>) - m.at(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>) ) * recip

    <span class="hljs-keyword">else</span> 
      i = <span class="hljs-number">0</span>
      <span class="hljs-keyword">if</span> m.at(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) &gt; m.at(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)
        i = <span class="hljs-number">1</span>
      <span class="hljs-keyword">if</span> m.at(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>) &gt; m.at(i,i)
        i = <span class="hljs-number">2</span>

      j = ( i + <span class="hljs-number">1</span> ) % <span class="hljs-number">3</span>
      k = ( j + <span class="hljs-number">1</span> ) % <span class="hljs-number">3</span>
      s = Math.sqrt(m.at(i,i) - m.at(j,j) - m.at(k,k) + <span class="hljs-number">1.0</span>)

      <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>
        <span class="hljs-property">@x</span> = <span class="hljs-number">0.5</span> * s
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> i == <span class="hljs-number">1</span>
        <span class="hljs-property">@y</span> = <span class="hljs-number">0.5</span> * s
      <span class="hljs-keyword">else</span> 
        <span class="hljs-property">@z</span> = <span class="hljs-number">0.5</span> * s

      recip = <span class="hljs-number">0.5</span> / s

      <span class="hljs-property">@w</span> = ( m.at(k,j) - m.at(j,k) ) * recip

      a = ( m.at(j,i) + m.at(i,j) ) * recip
      b = ( m.at(k,i) + m.at(i,k) ) * recip

      <span class="hljs-keyword">if</span> j == <span class="hljs-number">0</span>
        <span class="hljs-property">@x</span> = a
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> j == <span class="hljs-number">1</span>
        <span class="hljs-property">@y</span> = a
      <span class="hljs-keyword">else</span> 
        <span class="hljs-property">@z</span> = a

      <span class="hljs-keyword">if</span> k == <span class="hljs-number">0</span>
        <span class="hljs-property">@x</span> = b
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> k == <span class="hljs-number">1</span>
        <span class="hljs-property">@y</span> = b
      <span class="hljs-keyword">else</span> 
        <span class="hljs-property">@z</span> = b

    @

<span class="hljs-built_in">module</span>.exports = 
  Vec2 : Vec2
  Vec3 : Vec3
  Vec4 : Vec4
  Matrix2 : Matrix2
  Matrix3 : Matrix3
  Matrix4 : Matrix4
  radToDeg : radToDeg
  degToRad : degToRad
  <span class="hljs-attribute">Quaternion</span>: Quaternion
  PI : PI
  EPSILON : EPSILON
  Edge2 : Edge2</div></div></div></div></body></html>